import{d as R,u as G,G as H,j as c,o as T,c as A,q as L,b as a,m as r,w as _,B as j,f as B,t as g,r as z,F as Q,a as s,_ as q,e as O,C as M,N as W,O as K,a6 as X,R as J,K as I}from"./DIpL79ME.js";import F from"./BnfmgMFc.js";import{Q as P}from"./DFcLQhsV.js";import Y from"./BFJbChZv.js";import{S as Z}from"./B0Whmy7M.js";import{M as ee}from"./ByXHckbg.js";import{X as te}from"./BvuqPo7h.js";import{_ as ne}from"./CNtae-L3.js";import{_ as se}from"./D94DbZNy.js";import{C as oe}from"./BOkAGTVX.js";const re=R({__name:"CheckInAction",props:{fixed:{type:Boolean,default:!0}},emits:["checked-in"],setup(x,{emit:u}){const k=u,w=G(),i=z("idle");let l=null;const m=()=>{l&&(clearTimeout(l),l=null)},d=()=>{i.value==="idle"&&(i.value="loading",m(),l=setTimeout(()=>{i.value="done",w.push({level:"success",title:"Check-in",message:"–í—ã –Ω–∞ –º–µ—Å—Ç–µ! –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞."}),k("checked-in")},2e3))};H(()=>{m()});const y=c(()=>i.value==="loading"?"–ü—Ä–æ–≤–µ—Ä—è–µ–º –≥–µ–æ–ø–æ–∑–∏—Ü–∏—é...":i.value==="done"?"–£—Å–ø–µ—Ö":"üìç –Ø –Ω–∞ –º–µ—Å—Ç–µ");return(f,C)=>(T(),A("div",{class:L(x.fixed?"fixed inset-x-0 bottom-0 z-50":"")},[a(r(F),{class:"rounded-t-3xl border border-border bg-background/90 p-4 shadow-elevated backdrop-blur"},{default:_(()=>[a(r(j),{class:"h-12 w-full text-base",disabled:r(i)!=="idle",onClick:d},{default:_(()=>[B(g(r(y)),1)]),_:1},8,["disabled"])]),_:1})],2))}}),ae={class:"space-y-3"},ie={key:0,class:"flex flex-wrap items-center justify-between gap-2 rounded-2xl border border-primary/25 bg-primary/10 px-3 py-2 text-xs text-foreground"},le={class:"flex items-center gap-2"},ce={class:"flex items-center gap-2"},ue={class:"flex items-start justify-between gap-3"},de={class:"mt-2 text-lg font-semibold"},pe={class:"mt-1 text-sm text-white/70"},me={class:"mt-5 flex justify-center"},fe={class:"rounded-2xl bg-white p-4 shadow-lg"},ve={class:"mt-5 flex items-center justify-between text-xs text-white/70"},_e={class:"rounded-full border border-white/20 px-2 py-1"},ge={class:"relative flex h-full flex-col items-center justify-center gap-6 bg-white px-6"},he={class:"absolute right-4 top-4"},xe={class:"text-center"},ye={class:"mt-2 text-lg font-semibold text-foreground"},be={class:"rounded-3xl bg-white p-4 shadow-lg ring-1 ring-black/10"},ke=R({__name:"TicketWallet",props:{event:{}},setup(x){const u=x,k=o=>{if(!o||typeof o!="object")return null;const n=o,v=typeof n.uuid=="string"?n.uuid.trim():"";if(!v)return null;const e=typeof n.ticket_type=="string"?n.ticket_type.trim():"",t=typeof n.holder_name=="string"?n.holder_name.trim():"";return{uuid:v,ticket_type:e||"Standard",holder_name:t||"Guest"}},w=c(()=>{const o=u.event?.state_payload;return!o||typeof o!="object"?null:o}),i=c(()=>k(w.value?.ticket_preview??null)),l=c(()=>{const o=Array.isArray(u.event.tickets)?u.event.tickets[0]:null;return(typeof o?.name=="string"?o.name.trim():"")||"Access"}),m=c(()=>`SE-${Number.isFinite(Number(u.event.id))?String(u.event.id):"0001"}-PASS`),d=c(()=>{const o=i.value,n=typeof o?.uuid=="string"?o.uuid.trim():"",v=typeof o?.holder_name=="string"?o.holder_name.trim():"",e=typeof o?.ticket_type=="string"?o.ticket_type.trim():"";return{code:n?n.slice(0,8).toUpperCase():m.value,category:e||l.value,holder:v||"Guest"}}),y=c(()=>{const o=u.event.slug?.trim()||"event",n=i.value?.uuid?.trim()||"";return n?`${o}:${n}`:`${o}:${d.value.code}`}),f=z(!1),C=z(!0),b=W(),S=c(()=>b.public.enableAppPromotions!==!1),V=()=>{f.value=!0},p=()=>{C.value=!1};return(o,n)=>{const v=q;return T(),A(Q,null,[s("div",ae,[r(S)&&r(C)?(T(),A("div",ie,[s("p",le,[a(r(Z),{class:"h-4 w-4 text-primary"}),n[2]||(n[2]=s("span",null,"Internet can be unstable at venues. Save this ticket offline in the App.",-1))]),s("div",ce,[a(v,{to:"/app",class:"inline-flex items-center rounded-md bg-primary px-2.5 py-1 text-xs font-semibold text-primary-foreground transition hover:opacity-90"},{default:_(()=>[...n[3]||(n[3]=[B(" Open App ",-1)])]),_:1}),s("button",{type:"button",class:"rounded-md px-2 py-1 text-xs text-muted-foreground transition hover:bg-background hover:text-foreground",onClick:p}," Dismiss ")])])):O("",!0),a(r(F),{class:"relative overflow-hidden rounded-3xl border border-border bg-gradient-to-br from-slate-950 via-slate-900 to-slate-800 p-5 text-white shadow-2xl"},{default:_(()=>[s("div",ue,[s("div",null,[n[4]||(n[4]=s("p",{class:"text-xs uppercase tracking-[0.3em] text-white/70"},"–¶–∏—Ñ—Ä–æ–≤–æ–π –ø—Ä–æ–ø—É—Å–∫",-1)),s("h2",de,g(x.event.title||"Event Pass"),1),s("p",pe,g(r(d).category),1)]),a(r(j),{variant:"outline",size:"sm",class:"border-white/30 bg-white/10 text-white hover:bg-white/20",onClick:V},{default:_(()=>[a(r(ee),{class:"h-4 w-4"})]),_:1})]),s("div",me,[s("div",fe,[a(P,{value:r(y),size:220,level:"H"},null,8,["value"])])]),s("div",ve,[s("span",null,g(r(d).holder),1),s("span",_e,g(r(d).code),1)])]),_:1})]),a(r(Y),{modelValue:r(f),"onUpdate:modelValue":n[1]||(n[1]=e=>M(f)?f.value=e:null),class:"max-w-none w-full h-[100dvh] rounded-none border-0 p-0 bg-white"},{default:_(()=>[s("div",ge,[s("div",he,[a(r(j),{variant:"ghost",size:"icon",class:"rounded-full",onClick:n[0]||(n[0]=e=>f.value=!1)},{default:_(()=>[a(r(te),{class:"h-4 w-4"})]),_:1})]),s("div",xe,[n[5]||(n[5]=s("p",{class:"text-xs uppercase tracking-[0.3em] text-muted-foreground"},"–í–∞—à QR",-1)),s("p",ye,g(r(d).category),1)]),s("div",be,[a(P,{value:r(y),size:300,level:"H"},null,8,["value"])]),n[6]||(n[6]=s("p",{class:"text-sm text-muted-foreground"},"–ü–æ–∫–∞–∂–∏—Ç–µ QR –Ω–∞ –≤—Ö–æ–¥–µ",-1))])]),_:1},8,["modelValue"])],64)}}}),we={key:0,class:"space-y-6 px-4 pb-28 pt-4 md:px-0"},Ce={class:"flex items-center justify-between"},$e={class:"text-xl font-semibold text-foreground"},Ne={class:"text-sm text-muted-foreground"},Pe=R({__name:"CheckInWayView",props:{event:{}},setup(x){const u=x,k=K(),w=X(),i=c(()=>{const e=String(k.params.slug??"").trim();return e||u.event?.slug?.trim()||""}),l=e=>Array.isArray(e)?e:[],m=e=>e?{...e,tags:l(e.tags),occurrences:l(e.occurrences),tickets:l(e.tickets),images:l(e.images),sponsors:l(e.sponsors),participants_preview:l(e.participants_preview),stats:e.stats??{going_count:0,likes_count:0},current_mode:e.current_mode||"check_in"}:null,d=c(()=>m(u.event)),{data:y}=J(()=>`state2-1-event-${i.value}`,async()=>{if(!i.value)return d.value;const e=encodeURIComponent(i.value);try{const t=await $fetch(`/api/v1/events/${e}`,{baseURL:I("/api/v1/events")});return m(t)}catch{try{const t=await $fetch(`/api/v1/events/slug/${e}`,{baseURL:I("/api/v1/events/slug")});return m(t)}catch{return d.value}}},{server:!0,lazy:!1,default:()=>d.value,watch:[i,()=>u.event?.id]}),f=()=>{w.back()},C=()=>{},b=e=>{const t=typeof e=="number"?e:typeof e=="string"?Number(e):NaN;return Number.isFinite(t)?t:null},S=e=>{const t=e?.state_payload;return!t||typeof t!="object"?null:t},V=(e,t)=>{if(!e)return null;const h=b(t?.lat),$=b(t?.lon);return{...e,lat:h??b(e.lat),lon:$??b(e.lon)}},p=c(()=>{const e=y.value??d.value;if(!e)return null;const t=S(e),h=V(e.default_venue,t?.venue_geo);if(h)return{...e,default_venue:h};const $=e.occurrences?.[0]?.venue??null,N=V($,t?.venue_geo);if(!N)return e;const E=l(e.occurrences);if(!E.length)return{...e,default_venue:N};const[U,...D]=E;return{...e,occurrences:[{...U,venue:N},...D]}}),o=c(()=>{const t=S(p.value)?.ticket_preview;if(!t||typeof t!="object")return null;const h=typeof t.uuid=="string"?t.uuid.trim():"";if(!h)return null;const $=typeof t.ticket_type=="string"?t.ticket_type.trim():"",N=typeof t.holder_name=="string"?t.holder_name.trim():"";return{uuid:h,ticket_type:$||"Standard",holder_name:N||"Guest"}}),n=c(()=>p.value?.default_venue??p.value?.occurrences?.[0]?.venue??null),v=c(()=>o.value?.holder_name||"–≥–æ—Å—Ç—å");return(e,t)=>p.value?(T(),A("div",we,[s("header",Ce,[s("div",null,[t[0]||(t[0]=s("p",{class:"text-xs font-semibold uppercase tracking-[0.2em] text-muted-foreground"},"On the way",-1)),s("h1",$e,g(p.value.title||"Event"),1)]),a(r(j),{variant:"ghost",size:"sm",class:"gap-2",onClick:f},{default:_(()=>[a(r(oe),{class:"h-4 w-4"}),t[1]||(t[1]=B(" –ù–∞–∑–∞–¥ ",-1))]),_:1})]),s("p",Ne,"–ñ–¥–µ–º —Ç–µ–±—è, "+g(v.value)+"!",1),a(ke,{event:p.value},null,8,["event"]),a(se,{event:p.value,venue:n.value},null,8,["event","venue"]),a(ne,{event:p.value,mode:"venue"},null,8,["event"]),a(re,{onCheckedIn:C})])):O("",!0)}});export{Pe as _};
