import{H as W,p as Z}from"./DgUxy0CX.js";import{l as ee,r as l,d as P,o as i,c as r,F as q,a as e,u as s,b as a,_ as te,w as f,f as k,e as _,E as se,t as p,G as ae,B as T,k as V,a0 as R,T as H,Y as L,L as U,V as oe,a8 as ie,j as $,v as le}from"./BvmsJYLR.js";import{Q as A}from"./PV_K9qDU.js";import re from"./C0TRSMCl.js";import{S as ne}from"./CKtjksQb.js";import{X as j}from"./Bb8wBqGF.js";import{c as F}from"./5xDXAavj.js";import{M as de}from"./B7XCgDfu.js";import{G as ce}from"./DBxHthE1.js";import{_ as ue}from"./DlAUqK2U.js";import"./CrRG91Pn.js";import"./D6b4k1-A.js";import"./CV6lUnfE.js";import"./99XizrHh.js";import"./BcOzH3FQ.js";import"./Dgjf9vxP.js";const fe=F("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const pe=F("qr-code",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),me=ee("ticket-flow",()=>{const Q=l([{id:1,ticket_uuid:"b42c8f17-1d66-4fa2-9b1f-1a3d713efb91",event_title:"Signal Night",event_slug:"signal-night",start_time:"2026-02-14T19:00:00+03:00",venue:"Клуб Джао Да",city:"Москва",ticket_type:"VIP",status:"active"},{id:2,ticket_uuid:"a9fbf1db-2aa7-4f8b-8e66-6e2f4a6a3b2a",event_title:"Neon Streets",event_slug:"neon-streets",start_time:"2026-03-02T21:00:00+03:00",venue:"Main Stage",city:"Санкт-Петербург",ticket_type:"Танцпол",status:"active"},{id:3,ticket_uuid:"3f6ef68d-4f0b-4c5c-93dd-9fd25b9b3d45",event_title:"Garage Pulse",event_slug:"garage-pulse",start_time:"2025-12-01T20:00:00+03:00",venue:"Сцена 2",city:"Москва",ticket_type:"Танцпол",status:"used"}]),b=l(null),u=l(1),w=l(!1),x=l(""),g=l(""),y=l("default"),m=l(""),c=l(!1),h=n=>{b.value=n,n||(u.value=1)},v=n=>{u.value=Math.max(1,Math.min(10,n))};return{userTickets:Q,selectedTicketId:b,quantity:u,isGift:w,giftEmail:x,giftMessage:g,wrappingStyle:y,referralCode:m,referralApplied:c,setSelectedTicket:h,setQuantity:v,incrementQuantity:()=>{v(u.value+1)},decrementQuantity:()=>{v(u.value-1)},setGift:n=>{w.value=n,n||(x.value="",g.value="",y.value="default")},setReferralCode:n=>{m.value=n,c.value=!1},applyReferralMock:()=>(c.value=m.value.trim().length>=4,c.value),markGifted:n=>{const G=Q.value.find(C=>C.ticket_uuid===n);G&&(G.is_gifted=!0)},reset:()=>{b.value=null,u.value=1,w.value=!1,x.value="",g.value="",y.value="default",m.value="",c.value=!1}}}),ve={class:"space-y-6 pb-24"},xe={key:0,class:"flex flex-col gap-3 rounded-2xl border border-primary/20 bg-primary/5 p-4 text-sm text-foreground sm:flex-row sm:items-center sm:justify-between"},ge={class:"flex items-start gap-2 pr-2"},ye={class:"flex items-center gap-2"},_e={key:1,class:"rounded-2xl border border-border bg-card p-6 text-sm text-muted-foreground"},be={key:2,class:"grid gap-4"},he={class:"flex flex-wrap items-start justify-between gap-3"},ke={class:"text-lg font-bold text-foreground"},we={class:"mt-2 space-y-1 text-sm text-muted-foreground"},Me={class:"flex items-center gap-2"},Ce={class:"flex items-center gap-2"},Te={class:"flex flex-wrap items-center justify-between gap-3"},Qe={class:"text-base font-semibold text-foreground"},Ge={class:"flex flex-wrap items-center gap-2"},ze={key:1,class:"text-xs text-muted-foreground"},Re={class:"mt-4 flex flex-wrap items-center gap-4"},Se={class:"rounded-xl border border-border bg-background p-2"},Ve={class:"text-xs text-muted-foreground"},je={class:"mt-1 break-all"},Ne={class:"max-h-[90vh] w-full max-w-sm overflow-y-auto rounded-3xl border border-border bg-card p-6 shadow-elevated"},De={class:"flex items-center justify-between"},Ie={key:0,class:"mt-5 flex flex-col items-center gap-3 text-center"},Be={class:"rounded-2xl border border-border bg-background p-4"},Ee={class:"max-h-[90vh] w-full max-w-sm overflow-y-auto rounded-3xl border border-border bg-card p-6 shadow-elevated"},qe={class:"flex items-center justify-between"},He={class:"mt-4 space-y-3"},Le={key:0,class:"text-xs text-destructive"},Ue={key:1,class:"text-xs text-emerald-600"},$e=P({__name:"MyTicketsList",setup(Q){const b=me(),u=$(()=>b.userTickets),w=le(),x=l(!1),g=l(null),y=l(!1),m=l(null),c=l(""),h=l(""),v=l(""),M=l(""),S=l(!0),N=$(()=>w.public.enableAppPromotions!==!1),D=new Intl.DateTimeFormat("ru-RU",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"}),I=d=>{const t=new Date(d);return Number.isNaN(t.getTime())?"Дата уточняется":D.format(t)},B=d=>d==="active"?"Active":"Used",E=d=>d==="active"?"bg-emerald-500/10 text-emerald-600":"bg-muted text-muted-foreground",n=d=>d.status==="active"&&!d.is_gifted,G=d=>{g.value=d,x.value=!0},C=()=>{x.value=!1,g.value=null},O=d=>{m.value=d,c.value="",h.value="",v.value="",M.value="",y.value=!0},z=()=>{y.value=!1,m.value=null},X=()=>{if(m.value){if(!c.value.trim()){v.value="Укажи email получателя.";return}v.value="",b.markGifted(m.value.ticket_uuid),M.value="Билет отправлен другу!",setTimeout(()=>{z()},900)}},Y=()=>{S.value=!1};return(d,t)=>{const J=te;return i(),r(q,null,[e("div",ve,[t[11]||(t[11]=e("header",{class:"space-y-2"},[e("h1",{class:"text-2xl font-bold text-foreground"},"Мои билеты"),e("p",{class:"text-sm text-muted-foreground"}," Здесь собраны все билеты. Покажи QR на входе или отправь другу. ")],-1)),s(N)&&s(S)?(i(),r("div",xe,[e("p",ge,[a(s(ne),{class:"mt-0.5 h-4 w-4 shrink-0 text-primary"}),t[2]||(t[2]=e("span",null,"Internet can be unstable at venues. Save this ticket offline in the App.",-1))]),e("div",ye,[a(J,{to:"/app",class:"inline-flex items-center rounded-lg bg-primary px-3 py-1.5 text-xs font-semibold text-primary-foreground transition hover:opacity-90"},{default:f(()=>[...t[3]||(t[3]=[k(" Open App ",-1)])]),_:1}),e("button",{type:"button",class:"inline-flex h-8 w-8 items-center justify-center rounded-lg text-muted-foreground transition hover:bg-background hover:text-foreground","aria-label":"Dismiss app ticket hint",onClick:Y},[a(s(j),{class:"h-4 w-4"})])])])):_("",!0),s(u).length?(i(),r("div",be,[(i(!0),r(q,null,se(s(u),o=>(i(),r("article",{key:o.ticket_uuid,class:"ticket-card card-surface rounded-2xl border border-dashed border-border p-4 shadow-soft"},[e("div",he,[e("div",null,[t[4]||(t[4]=e("p",{class:"text-xs font-semibold uppercase tracking-[0.2em] text-muted-foreground"},"Событие",-1)),e("h2",ke,p(o.event_title),1),e("div",we,[e("p",Me,[a(s(fe),{class:"h-4 w-4 text-primary"}),k(" "+p(I(o.start_time)),1)]),e("p",Ce,[a(s(de),{class:"h-4 w-4 text-primary"}),k(" "+p(o.venue)+", "+p(o.city),1)])])]),e("span",{class:ae(["rounded-full px-3 py-1 text-xs font-semibold",E(o.status)])},p(B(o.status)),3)]),t[10]||(t[10]=e("div",{class:"ticket-divider"},null,-1)),e("div",Te,[e("div",null,[t[5]||(t[5]=e("p",{class:"text-xs font-semibold uppercase tracking-[0.2em] text-muted-foreground"},"Тип билета",-1)),e("p",Qe,p(o.ticket_type),1)]),e("div",Ge,[a(s(T),{variant:"outline",size:"sm",class:"gap-2",onClick:K=>G(o)},{default:f(()=>[a(s(pe),{class:"h-4 w-4"}),t[6]||(t[6]=k(" Показать QR на весь экран ",-1))]),_:1},8,["onClick"]),n(o)?(i(),V(s(T),{key:0,variant:"outline",size:"sm",class:"gap-2",onClick:K=>O(o)},{default:f(()=>[a(s(ce),{class:"h-4 w-4"}),t[7]||(t[7]=k(" Подарить ",-1))]),_:1},8,["onClick"])):(i(),r("span",ze,p(o.is_gifted?"Подарен":"Недоступно"),1))])]),e("div",Re,[e("div",Se,[a(A,{value:o.ticket_uuid,size:96,level:"M"},null,8,["value"])]),e("div",Ve,[t[8]||(t[8]=e("p",{class:"font-semibold text-foreground"},"UUID билета",-1)),e("p",je,p(o.ticket_uuid),1),t[9]||(t[9]=e("p",{class:"mt-2"},"Покажи QR-код на входе для быстрого сканирования.",-1))])])]))),128))])):(i(),r("div",_e," Пока нет билетов. Самое время выбрать событие! "))]),(i(),V(L,{to:"body"},[a(R,{"enter-active-class":"transition-opacity duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-opacity duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:f(()=>[s(x)?(i(),r("div",{key:0,class:"fixed inset-0 z-50 bg-black/70",onClick:C})):_("",!0)]),_:1}),a(R,{"enter-active-class":"transition-transform duration-300 ease-out","enter-from-class":"scale-95 opacity-0","enter-to-class":"scale-100 opacity-100","leave-active-class":"transition-transform duration-200 ease-in","leave-from-class":"scale-100 opacity-100","leave-to-class":"scale-95 opacity-0"},{default:f(()=>[s(x)?(i(),r("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center px-4 py-4",onClick:H(C,["self"])},[e("div",Ne,[e("div",De,[t[12]||(t[12]=e("h3",{class:"text-lg font-bold text-foreground"},"QR-код билета",-1)),a(s(T),{variant:"ghost",size:"icon",class:"rounded-full",onClick:C},{default:f(()=>[a(s(j),{class:"h-5 w-5"})]),_:1})]),s(g)?(i(),r("div",Ie,[e("div",Be,[a(A,{value:s(g).ticket_uuid,size:220,level:"M"},null,8,["value"])]),t[13]||(t[13]=e("p",{class:"text-xs text-muted-foreground"},"Покажи QR на входе для сканирования.",-1))])):_("",!0)])])):_("",!0)]),_:1})])),(i(),V(L,{to:"body"},[a(R,{"enter-active-class":"transition-opacity duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-opacity duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:f(()=>[s(y)?(i(),r("div",{key:0,class:"fixed inset-0 z-50 bg-black/60",onClick:z})):_("",!0)]),_:1}),a(R,{"enter-active-class":"transition-transform duration-300 ease-out","enter-from-class":"translate-y-4 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition-transform duration-200 ease-in","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-4 opacity-0"},{default:f(()=>[s(y)?(i(),r("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center px-4 py-4",onClick:H(z,["self"])},[e("div",Ee,[e("div",qe,[t[14]||(t[14]=e("h3",{class:"text-lg font-bold text-foreground"},"Подарить билет",-1)),a(s(T),{variant:"ghost",size:"icon",class:"rounded-full",onClick:z},{default:f(()=>[a(s(j),{class:"h-5 w-5"})]),_:1})]),e("div",He,[a(s(re),{modelValue:s(c),"onUpdate:modelValue":t[0]||(t[0]=o=>U(c)?c.value=o:null),type:"email",placeholder:"Email друга"},null,8,["modelValue"]),oe(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=o=>U(h)?h.value=o:null),rows:"3",placeholder:"Сообщение другу",class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},null,512),[[ie,s(h)]]),s(v)?(i(),r("p",Le,p(s(v)),1)):_("",!0),s(M)?(i(),r("p",Ue,p(s(M)),1)):_("",!0)]),a(s(T),{class:"mt-4 w-full",disabled:!s(c).trim(),onClick:X},{default:f(()=>[...t[15]||(t[15]=[k(" Отправить ",-1)])]),_:1},8,["disabled"])])])):_("",!0)]),_:1})]))],64)}}}),Ae=ue($e,[["__scopeId","data-v-81444ca5"]]),Pe={class:"page-wrapper"},Fe={class:"flex min-h-[calc(100dvh-9rem)] flex-col gap-4 lg:flex-row lg:items-start lg:gap-6"},Oe={class:"min-w-0 flex-1"},ct=P({__name:"index",setup(Q){return(b,u)=>(i(),r("div",Pe,[e("div",Fe,[a(W,{items:s(Z),class:"shrink-0"},null,8,["items"]),e("div",Oe,[a(Ae)])])]))}});export{ct as default};
