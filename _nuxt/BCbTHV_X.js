import W from"./CjpIm5Fr.js";import $ from"./DbnefyJH.js";import j from"./CNMEtP95.js";import z from"./B_ybT7kY.js";import{d as U,J as G,z as H,O as J,n as L,o as y,c as w,b as o,w as n,f as i,a as s,u as t,q as f,B as O,e as k,t as N,U as F,a1 as K,_ as Q,r as d,j as R,G as X}from"./DXztqjCQ.js";import Y from"./CLLKVBQL.js";import Z from"./C-Eyoouw.js";import{e as ee}from"./Cv8_oF2L.js";const te={class:"flex min-h-[calc(100vh-8rem)] items-center justify-center px-4 py-8"},se={class:"space-y-3"},oe={class:"space-y-2"},le={class:"space-y-2"},ae={class:"space-y-2"},re={class:"space-y-2"},ne={class:"space-y-2"},de={key:0,class:"mr-2 h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent"},ue={class:"flex items-start gap-3 rounded-xl border border-border px-3 py-2 text-sm text-muted-foreground"},ie=["disabled"],me={class:"text-center text-sm text-muted-foreground"},pe={key:0,class:"rounded-lg border border-destructive/20 bg-destructive/10 px-4 py-3 text-sm text-destructive"},ce=U({__name:"RegisterMainBlock",setup(B){const V=G(),m=H(),h=J(),p=d(""),c=d(""),v=d(""),u=d(""),_=d(""),x=d(!1),a=d(!1),l=d(""),M=R(()=>({path:"/auth/login",query:h.query})),q=R(()=>{const b=h.query.redirect;if(typeof b!="string")return"/profile/me";try{const e=decodeURIComponent(b);if(e.startsWith("/"))return e}catch{return"/profile/me"}return"/profile/me"});L([p,c,v,u,_],()=>{l.value&&(l.value="")});const A=async()=>{if(!x.value){l.value="Accept offer terms to continue.",m.push({level:"warning",title:"Registration",message:l.value,ttlMs:3500});return}if(!p.value.trim()||!c.value.trim()||!u.value){l.value="Заполни почту, логин и пароль.",m.push({level:"warning",title:"Регистрация",message:l.value,ttlMs:3500});return}if(u.value!==_.value){l.value="Пароли не совпадают.",m.push({level:"warning",title:"Регистрация",message:l.value,ttlMs:3500});return}a.value=!0,l.value="";try{await V.registerWithEmail({email:p.value.trim(),username:c.value.trim(),password:u.value,full_name:v.value.trim()||null}),m.push({level:"success",title:"Registration",message:"Account created. Welcome!"}),await X(q.value)}catch(b){l.value=ee(b,"Не удалось зарегистрироваться. Проверь данные и попробуй снова."),m.push({level:"error",title:"Регистрация",message:l.value})}finally{a.value=!1}};return(b,e)=>{const T=W,D=$,E=j,g=z,I=O,C=Q,P=Y,S=Z;return y(),w("div",te,[o(S,{class:"w-full max-w-md rounded-2xl border-border bg-white shadow-xl dark:bg-slate-900"},{default:n(()=>[o(E,{class:"space-y-1 text-center"},{default:n(()=>[o(T,{class:"text-2xl font-bold text-foreground"},{default:n(()=>[...e[6]||(e[6]=[i(" Регистрация ",-1)])]),_:1}),o(D,{class:"text-base text-muted-foreground"},{default:n(()=>[...e[7]||(e[7]=[i(" Создай аккаунт, чтобы сохранять историю и получать матчи ",-1)])]),_:1})]),_:1}),o(P,{class:"space-y-4"},{default:n(()=>[s("div",se,[s("div",oe,[e[8]||(e[8]=s("label",{for:"email",class:"text-sm font-medium text-foreground"}," Почта ",-1)),o(g,{id:"email",modelValue:t(p),"onUpdate:modelValue":e[0]||(e[0]=r=>f(p)?p.value=r:null),type:"email",placeholder:"example@site.ru",disabled:t(a)},null,8,["modelValue","disabled"])]),s("div",le,[e[9]||(e[9]=s("label",{for:"username",class:"text-sm font-medium text-foreground"}," Логин ",-1)),o(g,{id:"username",modelValue:t(c),"onUpdate:modelValue":e[1]||(e[1]=r=>f(c)?c.value=r:null),type:"text",placeholder:"nickname",disabled:t(a)},null,8,["modelValue","disabled"])]),s("div",ae,[e[10]||(e[10]=s("label",{for:"fullName",class:"text-sm font-medium text-foreground"}," Имя и фамилия (необязательно) ",-1)),o(g,{id:"fullName",modelValue:t(v),"onUpdate:modelValue":e[2]||(e[2]=r=>f(v)?v.value=r:null),type:"text",placeholder:"Александр Иванов",disabled:t(a)},null,8,["modelValue","disabled"])]),s("div",re,[e[11]||(e[11]=s("label",{for:"password",class:"text-sm font-medium text-foreground"}," Пароль ",-1)),o(g,{id:"password",modelValue:t(u),"onUpdate:modelValue":e[3]||(e[3]=r=>f(u)?u.value=r:null),type:"password",placeholder:"••••••••",disabled:t(a)},null,8,["modelValue","disabled"])]),s("div",ne,[e[12]||(e[12]=s("label",{for:"confirmPassword",class:"text-sm font-medium text-foreground"}," Повтори пароль ",-1)),o(g,{id:"confirmPassword",modelValue:t(_),"onUpdate:modelValue":e[4]||(e[4]=r=>f(_)?_.value=r:null),type:"password",placeholder:"••••••••",disabled:t(a)},null,8,["modelValue","disabled"])])]),o(I,{class:"w-full",size:"lg",disabled:t(a)||!t(x),onClick:A},{default:n(()=>[t(a)?(y(),w("span",de)):k("",!0),i(" "+N(t(a)?"Создаем...":"Создать аккаунт"),1)]),_:1},8,["disabled"]),s("label",ue,[F(s("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>f(x)?x.value=r:null),type:"checkbox",required:"",class:"mt-0.5 h-4 w-4 accent-primary",disabled:t(a)},null,8,ie),[[K,t(x)]]),s("span",null,[e[14]||(e[14]=i(" Я принимаю условия соглашения/оферты. ",-1)),o(C,{to:"/offer",class:"font-semibold text-primary hover:underline"},{default:n(()=>[...e[13]||(e[13]=[i(" Читать оферту ",-1)])]),_:1})])]),s("div",me,[e[16]||(e[16]=i(" Уже есть аккаунт? ",-1)),o(C,{to:t(M),class:"font-semibold text-primary hover:underline"},{default:n(()=>[...e[15]||(e[15]=[i(" Войти ",-1)])]),_:1},8,["to"])]),t(l)?(y(),w("div",pe,N(t(l)),1)):k("",!0)]),_:1})]),_:1})])}}}),fe={class:"page-wrapper"},he=U({__name:"index",setup(B){return(V,m)=>(y(),w("div",fe,[o(ce)]))}});export{he as default};
