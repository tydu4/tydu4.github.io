import{R as D,d as ve,C as K,g as ze,a6 as Ae,J as me,c as j,r as S,o as B,a7 as Ne,a as r,b as w,u as v,G as V,f as te,w as oe,a0 as se,t as ae,V as ne,L as re,a8 as le,e as ie,j as Oe}from"./BvmsJYLR.js";/* empty css        */import{_ as Ue}from"./DlAUqK2U.js";import{H as Fe,d as Ie}from"./DgUxy0CX.js";import{M as $e}from"./B7XCgDfu.js";import{U as Ve}from"./99XizrHh.js";import{S as je}from"./D5QgTEL4.js";import{P as Be}from"./BJZDLctM.js";import{M as He}from"./D2L4dJqR.js";import{c as Ke}from"./5xDXAavj.js";import"./CrRG91Pn.js";import"./D6b4k1-A.js";import"./CV6lUnfE.js";import"./BcOzH3FQ.js";import"./Dgjf9vxP.js";const Ze=Ke("locate-fixed",[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),fe=[37.61,55.75],be=9,ge=50,ye=50,xe=20260216,Ge=["Tech","Music","Startup","Food","Art","Wellness","Nightlife","Cinema"],Ye=["Neon","City","Afterwork","Underground","Open Air","Rooftop","Insider","Sunset"],Je=["Session","Meetup","Experience","Night","Mixer","Showcase","Lab","Pulse"],qe=["mila","den","nova","lex","arty","sasha","tori","pixel","vibe","echo"],Xe=["online","networking","exploring","at event","available"],ce=s=>Number(s.toFixed(6)),he=s=>{let a=s>>>0;return()=>(a=a*1664525+1013904223>>>0,a/4294967296)},F=(s,a)=>{if(s.length===0)throw new Error("Random source array must not be empty.");const n=Math.floor(a()*s.length);return s[Math.min(s.length-1,Math.max(0,n))]},_e=(s,a,n)=>{const d=n()*Math.PI*2,i=Math.sqrt(n())*a,p=s[1]*Math.PI/180,m=i*Math.cos(d)/110.574,y=i*Math.sin(d)/(111.32*Math.cos(p));return[ce(s[0]+y),ce(s[1]+m)]},We=(s,a)=>{const n=F(Ye,a),d=F(Je,a);return`${n} ${s} ${d}`},Qe=s=>{const a=new Date,n=Math.floor(s()*45),d=14+Math.floor(s()*9),i=[0,15,30,45][Math.floor(s()*4)]??0;return a.setDate(a.getDate()+n),a.setHours(d,i,0,0),a.toISOString()},et=s=>{const a=F(qe,s),n=Math.floor(10+s()*900);return`${a}${n}`},Ee=s=>({center:s.center??fe,count:Math.max(1,Math.floor(s.count??ge)),spreadKm:Math.max(1,s.spreadKm??be),seed:Math.floor(s.seed??xe)}),ue=(s={})=>{const a=Ee(s),n=he(a.seed),d=[];for(let i=0;i<a.count;i+=1){const p=i+1,m=F(Ge,n);d.push({type:"Feature",id:p,geometry:{type:"Point",coordinates:_e(a.center,a.spreadKm,n)},properties:{id:p,title:We(m,n),price:Math.floor(n()*4500),date:Qe(n),imageUrl:`https://picsum.photos/seed/discovery-event-${p}/480/320`,category:m}})}return{type:"FeatureCollection",features:d}},de=(s={})=>{const a=Ee({...s,count:s.count??ye}),n=he(a.seed),d=[];for(let i=0;i<a.count;i+=1){const p=i+1,m=p%70+1;d.push({type:"Feature",id:p,geometry:{type:"Point",coordinates:_e(a.center,a.spreadKm,n)},properties:{id:p,username:et(n),avatarUrl:`https://i.pravatar.cc/200?img=${m}`,status:F(Xe,n)}})}return{type:"FeatureCollection",features:d}},tt=(s={})=>{const a=s.center??fe,n=s.eventsCount??ge,d=s.peopleCount??ye,i=s.spreadKm??be,p=Math.floor(s.seed??xe),m=D(ue({center:a,count:n,spreadKm:i,seed:p+1})),y=D(de({center:a,count:d,spreadKm:i,seed:p+2}));let l=0;return{eventsCollection:m,peopleCollection:y,regenerate:()=>{l+=1,m.value=ue({center:a,count:n,spreadKm:i,seed:p+l*10+1}),y.value=de({center:a,count:d,spreadKm:i,seed:p+l*10+2})}}},h="events-source",_="people-source",O="events-clusters",Z="events-cluster-count",R="events-points",U="people-clusters",G="people-cluster-count",P="people-points",pe="#8b5cf6",ot=ve({__name:"EventsMap",props:{activeMode:{default:"events"},locateSignal:{default:0}},emits:["locate-error"],setup(s,{expose:a,emit:n}){const d=s,i=n,p=[37.61,55.75],m={version:8,sources:{"carto-dark":{type:"raster",tiles:["https://a.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png","https://b.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png","https://c.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png","https://d.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png"],tileSize:256,maxzoom:20,attribution:"&copy; OpenStreetMap contributors &copy; CARTO"}},layers:[{id:"carto-dark-layer",type:"raster",source:"carto-dark"}]},y=S(null),l=D(null),E=D(null),k=D(null),z=D(null),C=Ne({[h]:null,[_]:null}),{eventsCollection:M,peopleCollection:T}=tt({center:p,eventsCount:50,peopleCount:50,spreadKm:10}),A={events:h,people:_},L={events:[O,Z,R],people:[U,G,P]},c=new Intl.DateTimeFormat("en-GB",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}),f=e=>e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"),I=e=>{const t=l.value?.getSource(e);return t||null},Y=(e,t)=>{const o=l.value;!o||!o.getLayer(e)||o.setLayoutProperty(e,"visibility",t?"visible":"none")},N=e=>{const t=l.value;if(!t)return;const o=C[e];o!=null&&(t.setFeatureState({source:e,id:o},{hover:!1}),C[e]=null)},J=(e,t)=>{const o=l.value;if(!o||t===null||t===void 0)return;const u=C[e];u!==null&&u!==t&&o.setFeatureState({source:e,id:u},{hover:!1}),C[e]=t,o.setFeatureState({source:e,id:t},{hover:!0})},H=()=>{z.value?.remove(),z.value=null},q=()=>{l.value?.resize()},we=(e,t)=>{if(e==="events"){const g=t,$=f(g.title??"Event"),Te=f(g.category??"Event"),Re=f(g.imageUrl||`https://picsum.photos/seed/event-fallback-${g.id}/480/320`),Pe=g.date?c.format(new Date(g.date)):"Date TBA",De=Number.isFinite(g.price)?g.price>0?`$${g.price}`:"Free":"Price TBA";return`
      <div class="w-56 overflow-hidden rounded-xl bg-slate-900 text-slate-100 ring-1 ring-white/10 shadow-2xl">
        <img src="${Re}" alt="${$}" class="h-28 w-full object-cover" />
        <div class="space-y-1.5 p-3">
          <p class="text-[10px] uppercase tracking-[0.22em] text-violet-300">${Te}</p>
          <p class="text-sm font-bold leading-tight">${$}</p>
          <p class="text-xs text-slate-300">${f(Pe)} - ${f(De)}</p>
        </div>
      </div>
    `}const o=t,u=f(o.username||"guest"),b=f(o.avatarUrl||"https://i.pravatar.cc/200?img=1"),x=f(o.status||"available");return`
    <div class="w-52 rounded-xl bg-slate-900 p-3 text-slate-100 ring-1 ring-white/10 shadow-2xl">
      <div class="flex items-center gap-3">
        <img src="${b}" alt="${u}" class="h-11 w-11 rounded-full object-cover ring-2 ring-blue-400/70" />
        <div class="min-w-0">
          <p class="truncate text-sm font-bold">@${u}</p>
          <p class="text-xs text-slate-300">${x}</p>
        </div>
      </div>
    </div>
  `},ke=()=>{const e=I(h),t=I(_);e?.setData(M.value),t?.setData(T.value)},X=e=>{const t=e,o=e==="events"?"people":"events";L[t].forEach(x=>Y(x,!0)),L[o].forEach(x=>Y(x,!1));const u=A[t],b=t==="events"?M.value:T.value;I(u)?.setData(b),N(A[o]),l.value?.getCanvas().style.setProperty("cursor","")},W=(e,t)=>{const o=l.value;if(!o)return;const u=t.features?.[0];if(!u)return;const b=u.properties?.cluster_id;if(b==null)return;const x=I(A[e]);if(!x||typeof x.getClusterExpansionZoom!="function")return;const g=u.geometry.coordinates;x.getClusterExpansionZoom(Number(b)).then($=>{o.easeTo({center:g,zoom:Math.min($,16),duration:450})}).catch(()=>{})},Q=(e,t)=>{const o=l.value,u=E.value;if(!o||!u)return;const b=t.features?.[0];if(!b||!b.properties)return;const x=b.geometry.coordinates,g=we(e,b.properties);H(),z.value=new u.Popup({closeButton:!1,closeOnClick:!0,offset:16,className:"events-map-popup"}).setLngLat(x).setHTML(g).addTo(o)},Le=()=>{const e=l.value;if(!e)return;const t=o=>{e.on("mouseenter",o,()=>{e.getCanvas().style.cursor="pointer"}),e.on("mouseleave",o,()=>{e.getCanvas().style.cursor=""})};t(O),t(U),e.on("click",O,o=>W("events",o)),e.on("click",U,o=>W("people",o)),e.on("click",R,o=>Q("events",o)),e.on("click",P,o=>Q("people",o)),e.on("mousemove",R,o=>{const u=o.features?.[0]?.id;J(h,u??null),e.getCanvas().style.cursor="pointer"}),e.on("mousemove",P,o=>{const u=o.features?.[0]?.id;J(_,u??null),e.getCanvas().style.cursor="pointer"}),e.on("mouseleave",R,()=>{N(h),e.getCanvas().style.cursor=""}),e.on("mouseleave",P,()=>{N(_),e.getCanvas().style.cursor=""})},Se=()=>{const e=l.value;e&&(e.getSource(h)||e.addSource(h,{type:"geojson",data:M.value,cluster:!0,clusterRadius:55,clusterMaxZoom:14}),e.getSource(_)||e.addSource(_,{type:"geojson",data:T.value,cluster:!0,clusterRadius:55,clusterMaxZoom:14}),e.getLayer(O)||e.addLayer({id:O,type:"circle",source:h,filter:["has","point_count"],paint:{"circle-color":pe,"circle-opacity":.9,"circle-stroke-color":"#ddd6fe","circle-stroke-width":1.5,"circle-radius":["step",["get","point_count"],18,10,22,25,28,50,34,100,42]}}),e.getLayer(Z)||e.addLayer({id:Z,type:"symbol",source:h,filter:["has","point_count"],layout:{"text-field":["get","point_count_abbreviated"],"text-size":12},paint:{"text-color":"#f8fafc"}}),e.getLayer(R)||e.addLayer({id:R,type:"circle",source:h,filter:["!",["has","point_count"]],paint:{"circle-color":"#f43f5e","circle-stroke-color":"#ffffff","circle-stroke-width":1.75,"circle-opacity":.98,"circle-radius":["case",["boolean",["feature-state","hover"],!1],9,6.5],"circle-radius-transition":{duration:120,delay:0}}}),e.getLayer(U)||e.addLayer({id:U,type:"circle",source:_,filter:["has","point_count"],paint:{"circle-color":pe,"circle-opacity":.9,"circle-stroke-color":"#ddd6fe","circle-stroke-width":1.5,"circle-radius":["step",["get","point_count"],18,10,22,25,28,50,34,100,42]}}),e.getLayer(G)||e.addLayer({id:G,type:"symbol",source:_,filter:["has","point_count"],layout:{"text-field":["get","point_count_abbreviated"],"text-size":12},paint:{"text-color":"#f8fafc"}}),e.getLayer(P)||e.addLayer({id:P,type:"circle",source:_,filter:["!",["has","point_count"]],paint:{"circle-color":"#3b82f6","circle-stroke-color":"#ffffff","circle-stroke-width":1.75,"circle-opacity":.98,"circle-radius":["case",["boolean",["feature-state","hover"],!1],9,6.5],"circle-radius-transition":{duration:120,delay:0}}}),Le(),X(d.activeMode))},ee=()=>{if(!navigator.geolocation){i("locate-error","Geolocation is not supported on this device.");return}navigator.geolocation.getCurrentPosition(e=>{const t=l.value,o=E.value;if(!t||!o)return;const u=[e.coords.longitude,e.coords.latitude];if(k.value)k.value.setLngLat(u);else{const b=new o.Marker({color:"#22c55e"}).setLngLat(u);b.addTo(t),k.value=b}t.easeTo({center:u,zoom:Math.max(13.5,t.getZoom()),duration:900})},e=>{const t=e.code===e.PERMISSION_DENIED?"Location permission was denied.":"Unable to determine your location right now.";i("locate-error",t)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},Ce=()=>{l.value?.zoomIn({duration:220})},Me=()=>{l.value?.zoomOut({duration:220})};return K(()=>d.activeMode,e=>{l.value&&(H(),X(e))}),K(()=>d.locateSignal,(e,t)=>{e!==t&&ee()}),K([M,T],()=>{ke()}),a({locateMe:ee,zoomIn:Ce,zoomOut:Me}),ze(async()=>{if(y.value)try{const e=await Ae(()=>import("./kZj0XkdK.js").then(o=>o.m),[],import.meta.url);E.value=e;const t=new e.Map({container:y.value,style:m,center:p,zoom:11,minZoom:4,maxZoom:19,attributionControl:!1});t.on("load",()=>{Se(),t.resize()}),l.value=t,window.addEventListener("resize",q),requestAnimationFrame(()=>{t.resize()})}catch{i("locate-error","Map failed to initialize.")}}),me(()=>{H(),N(h),N(_),k.value?.remove(),k.value=null,window.removeEventListener("resize",q),l.value?.remove(),l.value=null,E.value=null}),(e,t)=>(B(),j("div",{ref_key:"mapContainerRef",ref:y,class:"absolute inset-0 h-full w-full"},null,512))}}),st=Object.assign(Ue(ot,[["__scopeId","data-v-fcdbb39f"]]),{__name:"DiscoveryEventsMap"}),at={class:"relative h-[100dvh] w-full overflow-hidden bg-slate-950 text-white"},nt={class:"relative z-0 h-[100dvh] w-full"},rt={class:"pointer-events-none absolute left-0 top-0 z-50 w-full p-2 pt-[calc(env(safe-area-inset-top)+0.5rem)] lg:w-auto lg:p-6 lg:pt-6"},lt={class:"pointer-events-none absolute inset-x-0 top-[calc(env(safe-area-inset-top)+4rem)] z-40 flex justify-center px-4 lg:top-6"},it={class:"pointer-events-auto inline-flex items-center gap-1 rounded-2xl border border-white/20 bg-slate-900/45 p-1 shadow-[0_10px_34px_-18px_rgba(15,23,42,0.95)] backdrop-blur-xl"},ct={class:"pointer-events-none absolute right-3 top-[calc(env(safe-area-inset-top)+7.5rem)] z-40 lg:right-6 lg:top-6"},ut={class:"pointer-events-auto flex flex-col items-end gap-2"},dt={key:0,class:"w-[min(20rem,calc(100vw-1.5rem))] rounded-2xl border border-white/20 bg-slate-950/70 p-4 shadow-[0_20px_50px_-30px_rgba(15,23,42,1)] backdrop-blur-xl"},pt={class:"mt-3 space-y-4 text-sm"},vt={class:"flex items-center justify-between gap-3"},mt={class:"block space-y-1.5"},ft={class:"flex items-center justify-between text-slate-200"},bt={class:"text-xs text-slate-300"},gt={class:"block space-y-1.5"},yt={class:"pointer-events-none absolute bottom-[calc(env(safe-area-inset-bottom)+1rem)] right-4 z-40 lg:right-6"},xt={class:"pointer-events-auto flex flex-col gap-2"},ht={key:0,class:"pointer-events-none absolute bottom-[calc(env(safe-area-inset-bottom)+1rem)] left-4 z-40 rounded-xl border border-rose-300/40 bg-rose-500/20 px-3 py-2 text-xs font-medium text-rose-100 backdrop-blur-md lg:left-6"},Ot=ve({__name:"index",setup(s){const a=S(null),n=S("events"),d=S(0),i=S(""),p=S(!1),m=S(8),y=S("");let l=null;const E=Oe({get:()=>n.value==="events",set:L=>{k(L?"events":"people")}}),k=L=>{n.value=L},z=()=>{p.value=!p.value},C=()=>{d.value+=1},M=()=>{a.value?.zoomIn?.()},T=()=>{a.value?.zoomOut?.()},A=L=>{i.value=L,l&&clearTimeout(l),l=setTimeout(()=>{i.value=""},3400)};return me(()=>{l&&clearTimeout(l)}),(L,c)=>(B(),j("div",at,[r("section",nt,[w(st,{ref_key:"mapRef",ref:a,"active-mode":v(n),"locate-signal":v(d),onLocateError:A},null,8,["active-mode","locate-signal"])]),r("div",rt,[w(Fe,{items:v(Ie),class:"pointer-events-auto lg:!static lg:!top-0"},null,8,["items"])]),r("div",lt,[r("div",it,[r("button",{type:"button",class:V(["inline-flex items-center gap-2 rounded-xl px-3.5 py-2 text-xs font-semibold transition",[v(n)==="events"?"bg-violet-500 text-white shadow-lg shadow-violet-500/30":"text-slate-200 hover:bg-white/10"]]),onClick:c[0]||(c[0]=f=>k("events"))},[w(v($e),{class:"h-3.5 w-3.5"}),c[5]||(c[5]=te(" Events ",-1))],2),r("button",{type:"button",class:V(["inline-flex items-center gap-2 rounded-xl px-3.5 py-2 text-xs font-semibold transition",[v(n)==="people"?"bg-violet-500 text-white shadow-lg shadow-violet-500/30":"text-slate-200 hover:bg-white/10"]]),onClick:c[1]||(c[1]=f=>k("people"))},[w(v(Ve),{class:"h-3.5 w-3.5"}),c[6]||(c[6]=te(" People ",-1))],2)])]),r("div",ct,[r("div",ut,[r("button",{type:"button",class:"inline-flex h-10 w-10 items-center justify-center rounded-xl border border-white/20 bg-slate-900/55 text-white backdrop-blur-xl transition hover:bg-slate-900/75",onClick:z},[w(v(je),{class:"h-4 w-4"})]),w(se,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"translate-y-2 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-2 opacity-0"},{default:oe(()=>[v(p)?(B(),j("aside",dt,[c[10]||(c[10]=r("p",{class:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-300"}," Map Settings ",-1)),r("div",pt,[r("label",vt,[c[7]||(c[7]=r("span",{class:"text-slate-200"},"Show Parties",-1)),r("button",{type:"button",class:V(["relative inline-flex h-6 w-11 items-center rounded-full border transition",v(E)?"border-violet-300/60 bg-violet-500/70":"border-white/30 bg-white/10"]),onClick:c[2]||(c[2]=f=>E.value=!v(E))},[r("span",{class:V(["inline-block h-4 w-4 transform rounded-full bg-white transition",v(E)?"translate-x-6":"translate-x-1"])},null,2)],2)]),r("label",mt,[r("span",ft,[c[8]||(c[8]=r("span",null,"Radius",-1)),r("span",bt,ae(v(m))+" km",1)]),ne(r("input",{"onUpdate:modelValue":c[3]||(c[3]=f=>re(m)?m.value=f:null),type:"range",min:"1",max:"50",step:"1",class:"h-1.5 w-full cursor-pointer appearance-none rounded-full bg-white/20 accent-violet-400"},null,512),[[le,v(m),void 0,{number:!0}]])]),r("label",gt,[c[9]||(c[9]=r("span",{class:"text-slate-200"},"Date",-1)),ne(r("input",{"onUpdate:modelValue":c[4]||(c[4]=f=>re(y)?y.value=f:null),type:"date",class:"w-full rounded-lg border border-white/20 bg-slate-900/70 px-3 py-2 text-sm text-slate-100 outline-none transition focus:border-violet-400"},null,512),[[le,v(y)]])])])])):ie("",!0)]),_:1})])]),r("div",yt,[r("div",xt,[r("button",{type:"button",class:"inline-flex h-11 w-11 items-center justify-center rounded-xl border border-white/20 bg-slate-900/55 text-white backdrop-blur-xl transition hover:bg-slate-900/80","aria-label":"Zoom in",onClick:M},[w(v(Be),{class:"h-4 w-4"})]),r("button",{type:"button",class:"inline-flex h-11 w-11 items-center justify-center rounded-xl border border-white/20 bg-slate-900/55 text-white backdrop-blur-xl transition hover:bg-slate-900/80","aria-label":"Zoom out",onClick:T},[w(v(He),{class:"h-4 w-4"})]),r("button",{type:"button",class:"inline-flex h-11 w-11 items-center justify-center rounded-xl border border-white/20 bg-slate-900/55 text-white backdrop-blur-xl transition hover:bg-slate-900/80","aria-label":"Find my location",onClick:C},[w(v(Ze),{class:"h-4 w-4"})])])]),w(se,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"translate-y-2 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-2 opacity-0"},{default:oe(()=>[v(i)?(B(),j("p",ht,ae(v(i)),1)):ie("",!0)]),_:1})]))}});export{Ot as default};
