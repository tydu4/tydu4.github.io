import{R as M,d as ae,C as z,g as Le,a6 as Ce,J as ne,c as K,r as O,o as G,a7 as Se,a as _,b as L,u as x,G as Q,f as V,w as Me,a0 as we,t as ke,e as Te}from"./D4tOOpea.js";/* empty css        */import{_ as Re}from"./DlAUqK2U.js";import{H as Pe,d as De}from"./D1uJsfV4.js";import{M as Ne}from"./DSD0DqAy.js";import{U as Ae}from"./D6B2Eigc.js";import{c as Ue}from"./BrE5OWI-.js";import"./CUtcqh3c.js";import"./CDoVUn-y.js";import"./BDIprTuF.js";import"./DQ6Ue2G3.js";import"./D_jAd2MS.js";const Oe=Ue("locate-fixed",[["line",{x1:"2",x2:"5",y1:"12",y2:"12",key:"bvdh0s"}],["line",{x1:"19",x2:"22",y1:"12",y2:"12",key:"1tbv5k"}],["line",{x1:"12",x2:"12",y1:"2",y2:"5",key:"11lu5j"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}],["circle",{cx:"12",cy:"12",r:"7",key:"fim9np"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),re=[37.61,55.75],ce=9,le=50,ie=50,ue=20260216,Fe=["Tech","Music","Startup","Food","Art","Wellness","Nightlife","Cinema"],Ie=["Neon","City","Afterwork","Underground","Open Air","Rooftop","Insider","Sunset"],$e=["Session","Meetup","Experience","Night","Mixer","Showcase","Lab","Pulse"],ze=["mila","den","nova","lex","arty","sasha","tori","pixel","vibe","echo"],Ve=["online","networking","exploring","at event","available"],ee=s=>Number(s.toFixed(6)),de=s=>{let a=s>>>0;return()=>(a=a*1664525+1013904223>>>0,a/4294967296)},R=(s,a)=>{if(s.length===0)throw new Error("Random source array must not be empty.");const n=Math.floor(a()*s.length);return s[Math.min(s.length-1,Math.max(0,n))]},pe=(s,a,n)=>{const c=n()*Math.PI*2,r=Math.sqrt(n())*a,u=s[1]*Math.PI/180,v=r*Math.cos(c)/110.574,h=r*Math.sin(c)/(111.32*Math.cos(u));return[ee(s[0]+h),ee(s[1]+v)]},Be=(s,a)=>{const n=R(Ie,a),c=R($e,a);return`${n} ${s} ${c}`},He=s=>{const a=new Date,n=Math.floor(s()*45),c=14+Math.floor(s()*9),r=[0,15,30,45][Math.floor(s()*4)]??0;return a.setDate(a.getDate()+n),a.setHours(c,r,0,0),a.toISOString()},Ke=s=>{const a=R(ze,s),n=Math.floor(10+s()*900);return`${a}${n}`},ve=s=>({center:s.center??re,count:Math.max(1,Math.floor(s.count??le)),spreadKm:Math.max(1,s.spreadKm??ce),seed:Math.floor(s.seed??ue)}),te=(s={})=>{const a=ve(s),n=de(a.seed),c=[];for(let r=0;r<a.count;r+=1){const u=r+1,v=R(Fe,n);c.push({type:"Feature",id:u,geometry:{type:"Point",coordinates:pe(a.center,a.spreadKm,n)},properties:{id:u,title:Be(v,n),price:Math.floor(n()*4500),date:He(n),imageUrl:`https://picsum.photos/seed/discovery-event-${u}/480/320`,category:v}})}return{type:"FeatureCollection",features:c}},oe=(s={})=>{const a=ve({...s,count:s.count??ie}),n=de(a.seed),c=[];for(let r=0;r<a.count;r+=1){const u=r+1,v=u%70+1;c.push({type:"Feature",id:u,geometry:{type:"Point",coordinates:pe(a.center,a.spreadKm,n)},properties:{id:u,username:Ke(n),avatarUrl:`https://i.pravatar.cc/200?img=${v}`,status:R(Ve,n)}})}return{type:"FeatureCollection",features:c}},Ge=(s={})=>{const a=s.center??re,n=s.eventsCount??le,c=s.peopleCount??ie,r=s.spreadKm??ce,u=Math.floor(s.seed??ue),v=M(te({center:a,count:n,spreadKm:r,seed:u+1})),h=M(oe({center:a,count:c,spreadKm:r,seed:u+2}));let l=0;return{eventsCollection:v,peopleCollection:h,regenerate:()=>{l+=1,v.value=te({center:a,count:n,spreadKm:r,seed:u+l*10+1}),h.value=oe({center:a,count:c,spreadKm:r,seed:u+l*10+2})}}},g="events-source",y="people-source",k="events-clusters",B="events-cluster-count",C="events-points",T="people-clusters",H="people-cluster-count",S="people-points",se="#8b5cf6",je=ae({__name:"EventsMap",props:{activeMode:{default:"events"},locateSignal:{default:0}},emits:["locate-error"],setup(s,{expose:a,emit:n}){const c=s,r=n,u=[37.61,55.75],v={version:8,sources:{"carto-dark":{type:"raster",tiles:["https://a.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png","https://b.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png","https://c.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png","https://d.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png"],tileSize:256,maxzoom:20,attribution:"&copy; OpenStreetMap contributors &copy; CARTO"}},layers:[{id:"carto-dark-layer",type:"raster",source:"carto-dark"}]},h=O(null),l=M(null),d=M(null),E=M(null),F=M(null),P=Se({[g]:null,[y]:null}),{eventsCollection:D,peopleCollection:N}=Ge({center:u,eventsCount:50,peopleCount:50,spreadKm:10}),I={events:g,people:y},j={events:[k,B,C],people:[T,H,S]},me=new Intl.DateTimeFormat("en-GB",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}),b=e=>e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;"),A=e=>{const t=l.value?.getSource(e);return t||null},Y=(e,t)=>{const o=l.value;!o||!o.getLayer(e)||o.setLayoutProperty(e,"visibility",t?"visible":"none")},w=e=>{const t=l.value;if(!t)return;const o=P[e];o!=null&&(t.setFeatureState({source:e,id:o},{hover:!1}),P[e]=null)},Z=(e,t)=>{const o=l.value;if(!o||t===null||t===void 0)return;const i=P[e];i!==null&&i!==t&&o.setFeatureState({source:e,id:i},{hover:!1}),P[e]=t,o.setFeatureState({source:e,id:t},{hover:!0})},$=()=>{F.value?.remove(),F.value=null},fe=(e,t)=>{if(e==="events"){const m=t,U=b(m.title??"Event"),xe=b(m.category??"Event"),_e=b(m.imageUrl||`https://picsum.photos/seed/event-fallback-${m.id}/480/320`),be=m.date?me.format(new Date(m.date)):"Date TBA",Ee=Number.isFinite(m.price)?m.price>0?`$${m.price}`:"Free":"Price TBA";return`
      <div class="w-56 overflow-hidden rounded-xl bg-slate-900 text-slate-100 ring-1 ring-white/10 shadow-2xl">
        <img src="${_e}" alt="${U}" class="h-28 w-full object-cover" />
        <div class="space-y-1.5 p-3">
          <p class="text-[10px] uppercase tracking-[0.22em] text-violet-300">${xe}</p>
          <p class="text-sm font-bold leading-tight">${U}</p>
          <p class="text-xs text-slate-300">${b(be)} - ${b(Ee)}</p>
        </div>
      </div>
    `}const o=t,i=b(o.username||"guest"),p=b(o.avatarUrl||"https://i.pravatar.cc/200?img=1"),f=b(o.status||"available");return`
    <div class="w-52 rounded-xl bg-slate-900 p-3 text-slate-100 ring-1 ring-white/10 shadow-2xl">
      <div class="flex items-center gap-3">
        <img src="${p}" alt="${i}" class="h-11 w-11 rounded-full object-cover ring-2 ring-blue-400/70" />
        <div class="min-w-0">
          <p class="truncate text-sm font-bold">@${i}</p>
          <p class="text-xs text-slate-300">${f}</p>
        </div>
      </div>
    </div>
  `},ge=()=>{const e=A(g),t=A(y);e?.setData(D.value),t?.setData(N.value)},J=e=>{const t=e,o=e==="events"?"people":"events";j[t].forEach(f=>Y(f,!0)),j[o].forEach(f=>Y(f,!1));const i=I[t],p=t==="events"?D.value:N.value;A(i)?.setData(p),w(I[o]),l.value?.getCanvas().style.setProperty("cursor","")},X=(e,t)=>{const o=l.value;if(!o)return;const i=t.features?.[0];if(!i)return;const p=i.properties?.cluster_id;if(p==null)return;const f=A(I[e]);if(!f||typeof f.getClusterExpansionZoom!="function")return;const m=i.geometry.coordinates;f.getClusterExpansionZoom(Number(p)).then(U=>{o.easeTo({center:m,zoom:Math.min(U,16),duration:450})}).catch(()=>{})},q=(e,t)=>{const o=l.value,i=d.value;if(!o||!i)return;const p=t.features?.[0];if(!p||!p.properties)return;const f=p.geometry.coordinates,m=fe(e,p.properties);$(),F.value=new i.Popup({closeButton:!1,closeOnClick:!0,offset:16,className:"events-map-popup"}).setLngLat(f).setHTML(m).addTo(o)},ye=()=>{const e=l.value;if(!e)return;const t=o=>{e.on("mouseenter",o,()=>{e.getCanvas().style.cursor="pointer"}),e.on("mouseleave",o,()=>{e.getCanvas().style.cursor=""})};t(k),t(T),e.on("click",k,o=>X("events",o)),e.on("click",T,o=>X("people",o)),e.on("click",C,o=>q("events",o)),e.on("click",S,o=>q("people",o)),e.on("mousemove",C,o=>{const i=o.features?.[0]?.id;Z(g,i??null),e.getCanvas().style.cursor="pointer"}),e.on("mousemove",S,o=>{const i=o.features?.[0]?.id;Z(y,i??null),e.getCanvas().style.cursor="pointer"}),e.on("mouseleave",C,()=>{w(g),e.getCanvas().style.cursor=""}),e.on("mouseleave",S,()=>{w(y),e.getCanvas().style.cursor=""})},he=()=>{const e=l.value;e&&(e.getSource(g)||e.addSource(g,{type:"geojson",data:D.value,cluster:!0,clusterRadius:55,clusterMaxZoom:14}),e.getSource(y)||e.addSource(y,{type:"geojson",data:N.value,cluster:!0,clusterRadius:55,clusterMaxZoom:14}),e.getLayer(k)||e.addLayer({id:k,type:"circle",source:g,filter:["has","point_count"],paint:{"circle-color":se,"circle-opacity":.9,"circle-stroke-color":"#ddd6fe","circle-stroke-width":1.5,"circle-radius":["step",["get","point_count"],18,10,22,25,28,50,34,100,42]}}),e.getLayer(B)||e.addLayer({id:B,type:"symbol",source:g,filter:["has","point_count"],layout:{"text-field":["get","point_count_abbreviated"],"text-size":12},paint:{"text-color":"#f8fafc"}}),e.getLayer(C)||e.addLayer({id:C,type:"circle",source:g,filter:["!",["has","point_count"]],paint:{"circle-color":"#f43f5e","circle-stroke-color":"#ffffff","circle-stroke-width":1.75,"circle-opacity":.98,"circle-radius":["case",["boolean",["feature-state","hover"],!1],9,6.5],"circle-radius-transition":{duration:120,delay:0}}}),e.getLayer(T)||e.addLayer({id:T,type:"circle",source:y,filter:["has","point_count"],paint:{"circle-color":se,"circle-opacity":.9,"circle-stroke-color":"#ddd6fe","circle-stroke-width":1.5,"circle-radius":["step",["get","point_count"],18,10,22,25,28,50,34,100,42]}}),e.getLayer(H)||e.addLayer({id:H,type:"symbol",source:y,filter:["has","point_count"],layout:{"text-field":["get","point_count_abbreviated"],"text-size":12},paint:{"text-color":"#f8fafc"}}),e.getLayer(S)||e.addLayer({id:S,type:"circle",source:y,filter:["!",["has","point_count"]],paint:{"circle-color":"#3b82f6","circle-stroke-color":"#ffffff","circle-stroke-width":1.75,"circle-opacity":.98,"circle-radius":["case",["boolean",["feature-state","hover"],!1],9,6.5],"circle-radius-transition":{duration:120,delay:0}}}),ye(),J(c.activeMode))},W=()=>{if(!navigator.geolocation){r("locate-error","Geolocation is not supported on this device.");return}navigator.geolocation.getCurrentPosition(e=>{const t=l.value,o=d.value;if(!t||!o)return;const i=[e.coords.longitude,e.coords.latitude];if(E.value)E.value.setLngLat(i);else{const p=new o.Marker({color:"#22c55e"}).setLngLat(i);p.addTo(t),E.value=p}t.easeTo({center:i,zoom:Math.max(13.5,t.getZoom()),duration:900})},e=>{const t=e.code===e.PERMISSION_DENIED?"Location permission was denied.":"Unable to determine your location right now.";r("locate-error",t)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})};return z(()=>c.activeMode,e=>{l.value&&($(),J(e))}),z(()=>c.locateSignal,(e,t)=>{e!==t&&W()}),z([D,N],()=>{ge()}),a({locateMe:W}),Le(async()=>{if(h.value)try{const e=await Ce(()=>import("./kZj0XkdK.js").then(o=>o.m),[],import.meta.url);d.value=e;const t=new e.Map({container:h.value,style:v,center:u,zoom:11,minZoom:4,maxZoom:19,attributionControl:!1});t.addControl(new e.NavigationControl({showCompass:!1}),"top-right"),t.on("load",()=>{he(),t.resize()}),l.value=t}catch{r("locate-error","Map failed to initialize.")}}),ne(()=>{$(),w(g),w(y),E.value?.remove(),E.value=null,l.value?.remove(),l.value=null,d.value=null}),(e,t)=>(G(),K("div",{ref_key:"mapContainerRef",ref:h,class:"absolute inset-0"},null,512))}}),Ye=Object.assign(Re(je,[["__scopeId","data-v-368ce70d"]]),{__name:"DiscoveryEventsMap"}),Ze={class:"page-wrapper"},Je={class:"flex min-h-[calc(100dvh-9rem)] flex-col gap-4 lg:flex-row lg:items-start lg:gap-6"},Xe={class:"min-w-0 flex-1"},qe={class:"relative h-[calc(100dvh-11.25rem)] min-h-[520px] overflow-hidden rounded-3xl border border-white/15 bg-slate-950 shadow-[0_26px_60px_-34px_rgba(15,23,42,0.95)]"},We={class:"pointer-events-none absolute inset-x-0 top-4 z-20 flex justify-center px-4"},Qe={class:"pointer-events-auto inline-flex items-center gap-1 rounded-2xl border border-white/20 bg-slate-900/55 p-1 backdrop-blur-xl shadow-[0_10px_34px_-18px_rgba(15,23,42,0.95)]"},et={class:"pointer-events-none absolute bottom-5 right-5 z-20"},tt={key:0,class:"absolute bottom-5 left-5 z-20 rounded-xl border border-rose-300/40 bg-rose-500/20 px-3 py-2 text-xs font-medium text-rose-100 backdrop-blur-md"},mt=ae({__name:"index",setup(s){const a=O("events"),n=O(0),c=O("");let r=null;const u=l=>{a.value=l},v=()=>{n.value+=1},h=l=>{c.value=l,r&&clearTimeout(r),r=setTimeout(()=>{c.value=""},3400)};return ne(()=>{r&&clearTimeout(r)}),(l,d)=>(G(),K("div",Ze,[_("div",Je,[L(Pe,{items:x(De),class:"shrink-0"},null,8,["items"]),_("div",Xe,[_("section",qe,[L(Ye,{"active-mode":x(a),"locate-signal":x(n),onLocateError:h},null,8,["active-mode","locate-signal"]),_("div",We,[_("div",Qe,[_("button",{type:"button",class:Q(["inline-flex items-center gap-2 rounded-xl px-3.5 py-2 text-xs font-semibold transition",[x(a)==="events"?"bg-violet-500 text-white shadow-lg shadow-violet-500/30":"text-slate-200 hover:bg-white/10"]]),onClick:d[0]||(d[0]=E=>u("events"))},[L(x(Ne),{class:"h-3.5 w-3.5"}),d[2]||(d[2]=V(" Events ",-1))],2),_("button",{type:"button",class:Q(["inline-flex items-center gap-2 rounded-xl px-3.5 py-2 text-xs font-semibold transition",[x(a)==="people"?"bg-violet-500 text-white shadow-lg shadow-violet-500/30":"text-slate-200 hover:bg-white/10"]]),onClick:d[1]||(d[1]=E=>u("people"))},[L(x(Ae),{class:"h-3.5 w-3.5"}),d[3]||(d[3]=V(" People ",-1))],2)])]),_("div",et,[_("button",{type:"button",class:"pointer-events-auto inline-flex items-center gap-2 rounded-xl border border-white/25 bg-slate-900/65 px-4 py-2 text-xs font-semibold text-white backdrop-blur-xl transition hover:bg-slate-900/85",onClick:v},[L(x(Oe),{class:"h-4 w-4"}),d[4]||(d[4]=V(" Find Me ",-1))])]),L(we,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"translate-y-2 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-2 opacity-0"},{default:Me(()=>[x(c)?(G(),K("p",tt,ke(x(c)),1)):Te("",!0)]),_:1})])])])]))}});export{mt as default};
