import{d as c,u as g,a as l,e as o,n}from"./D9Gj93nn.js";const f=c(async i=>{let e,r;if(i.path==="/login")return;const t=g(),a=l(),s=i.path==="/onboarding",h=i.path.startsWith("/settings");if(!t.isAuthInitialized)try{[e,r]=o(()=>t.initAuth()),await e,r()}catch{}if(!t.token)return n("/login");try{[e,r]=o(()=>t.ensureUser()),await e,r()}catch{return t.logout(),n("/login")}if(!t.user)return t.logout(),n("/login");try{[e,r]=o(()=>a.fetchMyEntities()),await e,r()}catch(u){console.warn("[auth-organizer] Failed to load owner entities",u)}if(!a.hasEntities&&!s)return n("/onboarding");if(a.currentContext?.type==="venue")return!i.path.startsWith("/venue")&&!s&&!h?n("/venue/overview"):void 0;if(a.currentContext?.type==="organizer"&&i.path.startsWith("/venue"))return n("/")});export{f as default};
