import{b as mt,C as u,D as e,M as m,R as s,N as n,O as l,J as D,T as O,Q as j,U as T,V as C,S as N,I as F,l as g,B as d,P as i,W as G,X as Z,Y as ct,Z as ft,$ as pt,t as p}from"./CKBAJM5x.js";import V from"./C3SSI5uS.js";import xt from"./p1n9S_jB.js";import gt from"./DJkm0BZd.js";import bt from"./DlaggF4v.js";import vt from"./CjUUo47n.js";import yt from"./DhQzSmfs.js";import S from"./uu2EcCNt.js";import B from"./y4Sw6LBA.js";import $ from"./C2gErE1m.js";import wt from"./DOGxHbnw.js";import"./CkYB-R1u.js";import"./c5FhCeC0.js";const ht={class:"space-y-6 pb-4"},_t={class:"rounded-2xl border border-border bg-card p-6 shadow-sm"},kt={class:"flex flex-wrap items-start justify-between gap-4"},Tt={class:"mt-3 text-4xl font-extrabold leading-none text-foreground"},Ct={class:"rounded-2xl border border-border bg-card p-6 shadow-sm"},$t={class:"flex flex-wrap items-end justify-between gap-4"},Dt={class:"flex flex-wrap items-end gap-2"},Nt={class:"space-y-1"},Vt={class:"space-y-1"},Bt={class:"mt-4 rounded-xl border border-border"},It={class:"grid gap-4 lg:grid-cols-2"},Mt={class:"rounded-2xl border border-border bg-card p-6 shadow-sm"},jt={class:"mt-4 overflow-x-auto"},Ft=["viewBox"],St=["y1","x2","y2"],Ut=["x","y"],Rt=["d"],Wt=["d"],Lt=["cx","cy"],Pt={class:"rounded-2xl border border-border bg-card p-6 shadow-sm"},zt={class:"mt-5 flex flex-col items-center gap-5 md:flex-row md:items-start"},Et={class:"flex h-24 w-24 flex-col items-center justify-center rounded-full border border-border bg-card"},Ht={class:"text-lg font-bold text-foreground"},Ot={class:"w-full space-y-2"},Gt={class:"flex items-center gap-2"},Zt={class:"text-sm font-medium text-foreground"},At={class:"text-sm text-muted-foreground"},Jt={class:"space-y-4"},Qt={class:"space-y-3"},Xt={class:"block space-y-1"},Yt={class:"block space-y-1"},qt={class:"flex items-center gap-2 rounded-lg border border-border bg-background/60 px-3 py-2 text-sm text-foreground"},Kt=["disabled"],te={key:0,class:"text-sm text-destructive"},ee={class:"flex justify-end gap-2"},U=680,w=260,c=36,ge=mt({__name:"index",setup(oe){const I=g(154e3),h=g(!1),_=g(""),f=pt({amount:"",method:"bank_account",generateInvoice:!0}),v=g(""),y=g(""),R=g([{id:1,date:"2026-02-11T20:34:00",type:"ticket_sale",amount:5400,status:"completed"},{id:2,date:"2026-02-11T13:10:00",type:"ticket_sale",amount:3600,status:"completed"},{id:3,date:"2026-02-10T16:47:00",type:"withdrawal",amount:12e3,status:"completed"},{id:4,date:"2026-02-10T10:16:00",type:"refund",amount:1800,status:"completed"},{id:5,date:"2026-02-09T18:05:00",type:"ticket_sale",amount:7800,status:"completed"},{id:6,date:"2026-02-08T12:21:00",type:"withdrawal",amount:8500,status:"pending"}]),b=g([{date:"2026-02-05",amount:18e3},{date:"2026-02-06",amount:22e3},{date:"2026-02-07",amount:27e3},{date:"2026-02-08",amount:21e3},{date:"2026-02-09",amount:29500},{date:"2026-02-10",amount:33e3},{date:"2026-02-11",amount:36500}]),M=g([{type:"Standard",sold:168,color:"#2563eb"},{type:"VIP",sold:54,color:"#16a34a"},{type:"Early Bird",sold:92,color:"#f59e0b"},{type:"Backstage",sold:18,color:"#dc2626"}]),W=new Intl.NumberFormat("ru-RU"),A=new Intl.DateTimeFormat("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),J=new Intl.DateTimeFormat("ru-RU",{day:"2-digit",month:"short"}),L=r=>`${W.format(Math.round(r))} ₽`,Q=r=>{const t=new Date(r);return Number.isNaN(t.getTime())?"—":A.format(t)},X=r=>{const t=new Date(r);return Number.isNaN(t.getTime())?"—":J.format(t)},Y={ticket_sale:"Продажа билета",withdrawal:"Вывод",refund:"Возврат"},q={completed:"Завершено",pending:"В обработке",failed:"Ошибка"},K={completed:"success",pending:"warning",failed:"outline"},tt={completed:"",pending:"",failed:"text-destructive border-destructive/40 bg-destructive/10"},et={ticket_sale:"+",withdrawal:"-",refund:"-"},ot={ticket_sale:"text-emerald-600",withdrawal:"text-foreground",refund:"text-destructive"},P=p(()=>{const r=v.value?new Date(`${v.value}T00:00:00`):null,t=y.value?new Date(`${y.value}T23:59:59`):null;return R.value.filter(o=>{const a=new Date(o.date);return!(Number.isNaN(a.getTime())||r&&a<r||t&&a>t)})}),z=p(()=>Math.max(...b.value.map(r=>r.amount),1)),x=p(()=>{if(!b.value.length)return[];const r=U-c*2,t=w-c*2;return b.value.map((o,a)=>{const ut=b.value.length===1?c+r/2:c+a/(b.value.length-1)*r,it=w-c-o.amount/z.value*t;return{...o,x:ut,y:it}})}),E=p(()=>x.value.length?x.value.map((r,t)=>`${t===0?"M":"L"} ${r.x} ${r.y}`).join(" "):""),H=p(()=>{if(!x.value.length)return"";const r=x.value[0],t=x.value[x.value.length-1],o=x.value.map(a=>`L ${a.x} ${a.y}`).join(" ");return`M ${r.x} ${w-c} ${o} L ${t.x} ${w-c} Z`}),st=p(()=>Array.from({length:5},(t,o)=>{const a=o/4;return{y:c+a*(w-c*2),value:Math.round(z.value*(1-a))}})),k=p(()=>M.value.reduce((r,t)=>r+t.sold,0)),rt=p(()=>M.value.map(r=>({...r,percent:k.value?Math.round(r.sold/k.value*100):0}))),lt=p(()=>{if(!k.value)return"conic-gradient(#e2e8f0 0deg 360deg)";let r=0;return`conic-gradient(${M.value.map(o=>{const a=r;return r+=o.sold/k.value*360,`${o.color} ${a}deg ${r}deg`}).join(", ")})`}),nt=()=>{f.amount="",f.method="bank_account",f.generateInvoice=!0,_.value=""},at=()=>{nt(),h.value=!0},dt=()=>{const r=Number(f.amount);if(!r||Number.isNaN(r)||r<=0){_.value="Введите сумму больше 0.";return}if(r>I.value){_.value="Недостаточно средств на балансе.";return}I.value-=r,R.value.unshift({id:Date.now(),date:new Date().toISOString(),type:"withdrawal",amount:r,status:"pending"}),h.value=!1};return(r,t)=>(d(),u("div",ht,[e("section",_t,[e("div",kt,[e("div",null,[t[7]||(t[7]=e("p",{class:"text-xs font-semibold uppercase tracking-[0.2em] text-muted-foreground"},"Wallet",-1)),t[8]||(t[8]=e("h2",{class:"mt-2 text-lg font-semibold text-foreground"},"Доступный баланс",-1)),e("p",Tt,m(L(s(I))),1)]),n(s(V),{size:"lg",onClick:at},{default:l(()=>[...t[9]||(t[9]=[i("Вывести средства",-1)])]),_:1})])]),e("section",Ct,[e("div",$t,[t[13]||(t[13]=e("div",null,[e("h3",{class:"text-lg font-semibold text-foreground"},"История транзакций"),e("p",{class:"mt-1 text-sm text-muted-foreground"},"Фильтруйте операции по диапазону дат.")],-1)),e("div",Dt,[e("label",Nt,[t[10]||(t[10]=e("span",{class:"text-xs text-muted-foreground"},"С",-1)),D(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>j(v)?v.value=o:null),type:"date",class:"h-10 rounded-md border border-input bg-background px-3 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"},null,512),[[O,s(v)]])]),e("label",Vt,[t[11]||(t[11]=e("span",{class:"text-xs text-muted-foreground"},"По",-1)),D(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>j(y)?y.value=o:null),type:"date",class:"h-10 rounded-md border border-input bg-background px-3 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"},null,512),[[O,s(y)]])]),n(s(V),{variant:"outline",onClick:t[2]||(t[2]=o=>{v.value="",y.value=""})},{default:l(()=>[...t[12]||(t[12]=[i("Сбросить",-1)])]),_:1})])]),e("div",Bt,[n(s(bt),null,{default:l(()=>[n(s(vt),null,{default:l(()=>[n(s(S),null,{default:l(()=>[n(s(B),null,{default:l(()=>[...t[14]||(t[14]=[i("Дата",-1)])]),_:1}),n(s(B),null,{default:l(()=>[...t[15]||(t[15]=[i("Тип",-1)])]),_:1}),n(s(B),{class:"text-right"},{default:l(()=>[...t[16]||(t[16]=[i("Сумма",-1)])]),_:1}),n(s(B),{class:"text-right"},{default:l(()=>[...t[17]||(t[17]=[i("Статус",-1)])]),_:1})]),_:1})]),_:1}),n(s(yt),null,{default:l(()=>[(d(!0),u(T,null,C(s(P),o=>(d(),G(s(S),{key:o.id},{default:l(()=>[n(s($),{class:"text-sm text-foreground"},{default:l(()=>[i(m(Q(o.date)),1)]),_:2},1024),n(s($),{class:"text-sm text-foreground"},{default:l(()=>[i(m(Y[o.type]),1)]),_:2},1024),n(s($),{class:Z(["text-right text-sm font-semibold",ot[o.type]])},{default:l(()=>[i(m(et[o.type])+m(L(o.amount)),1)]),_:2},1032,["class"]),n(s($),{class:"text-right"},{default:l(()=>[n(s(gt),{variant:K[o.status],class:Z(tt[o.status])},{default:l(()=>[i(m(q[o.status]),1)]),_:2},1032,["variant","class"])]),_:2},1024)]),_:2},1024))),128)),s(P).length?N("",!0):(d(),G(s(S),{key:0},{default:l(()=>[n(s($),{colspan:"4",class:"py-8 text-center text-sm text-muted-foreground"},{default:l(()=>[...t[18]||(t[18]=[i(" За выбранный период транзакций нет. ",-1)])]),_:1})]),_:1}))]),_:1})]),_:1})])]),e("section",It,[e("div",Mt,[t[20]||(t[20]=e("h3",{class:"text-lg font-semibold text-foreground"},"Выручка по дням",-1)),e("div",jt,[(d(),u("svg",{viewBox:`0 0 ${U} ${w}`,class:"h-64 w-full min-w-[680px]"},[t[19]||(t[19]=e("defs",null,[e("linearGradient",{id:"revenue-area",x1:"0",y1:"0",x2:"0",y2:"1"},[e("stop",{offset:"0%","stop-color":"#2563eb","stop-opacity":"0.24"}),e("stop",{offset:"100%","stop-color":"#2563eb","stop-opacity":"0.04"})])],-1)),(d(!0),u(T,null,C(s(st),o=>(d(),u("g",{key:o.value},[e("line",{x1:c,y1:o.y,x2:U-c,y2:o.y,stroke:"currentColor","stroke-opacity":"0.12"},null,8,St),e("text",{x:c-8,y:o.y+4,"font-size":"11","text-anchor":"end",fill:"currentColor","fill-opacity":"0.7"},m(s(W).format(o.value)),9,Ut)]))),128)),s(H)?(d(),u("path",{key:0,d:s(H),fill:"url(#revenue-area)"},null,8,Rt)):N("",!0),s(E)?(d(),u("path",{key:1,d:s(E),fill:"none",stroke:"#2563eb","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},null,8,Wt)):N("",!0),(d(!0),u(T,null,C(s(x),o=>(d(),u("circle",{key:o.date,cx:o.x,cy:o.y,r:"4.5",fill:"#2563eb"},null,8,Lt))),128))],8,Ft))]),e("div",{class:"mt-3 grid gap-2",style:F({gridTemplateColumns:`repeat(${Math.max(s(b).length,1)}, minmax(0, 1fr))`})},[(d(!0),u(T,null,C(s(b),o=>(d(),u("p",{key:o.date,class:"text-center text-xs font-medium text-muted-foreground"},m(X(o.date)),1))),128))],4)]),e("div",Pt,[t[22]||(t[22]=e("h3",{class:"text-lg font-semibold text-foreground"},"Продажи по типам билетов",-1)),e("div",zt,[e("div",{class:"flex h-52 w-52 items-center justify-center rounded-full border border-border",style:F({background:s(lt)})},[e("div",Et,[t[21]||(t[21]=e("p",{class:"text-[11px] uppercase tracking-[0.16em] text-muted-foreground"},"Билеты",-1)),e("p",Ht,m(s(k)),1)])],4),e("div",Ot,[(d(!0),u(T,null,C(s(rt),o=>(d(),u("div",{key:o.type,class:"flex items-center justify-between rounded-xl border border-border bg-background/60 px-3 py-2"},[e("div",Gt,[e("span",{class:"h-2.5 w-2.5 rounded-full",style:F({backgroundColor:o.color})},null,4),e("span",Zt,m(o.type),1)]),e("p",At,m(o.sold)+" шт ("+m(o.percent)+"%) ",1)]))),128))])])])]),n(s(wt),{modelValue:s(h),"onUpdate:modelValue":t[6]||(t[6]=o=>j(h)?h.value=o:null)},{default:l(({close:o})=>[e("div",Jt,[t[29]||(t[29]=e("div",null,[e("h3",{class:"text-lg font-semibold text-foreground"},"Вывод средств"),e("p",{class:"mt-1 text-sm text-muted-foreground"},"Заполните параметры вывода и подтвердите операцию.")],-1)),e("div",Qt,[e("label",Xt,[t[23]||(t[23]=e("span",{class:"text-sm font-medium text-foreground"},"Сумма",-1)),n(s(xt),{modelValue:s(f).amount,"onUpdate:modelValue":t[3]||(t[3]=a=>s(f).amount=a),type:"number",placeholder:"Например, 10000",class:"w-full"},null,8,["modelValue"])]),e("label",Yt,[t[25]||(t[25]=e("span",{class:"text-sm font-medium text-foreground"},"Способ",-1)),D(e("select",{"onUpdate:modelValue":t[4]||(t[4]=a=>s(f).method=a),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring"},[...t[24]||(t[24]=[e("option",{value:"bank_account"},"Расчетный счет",-1),e("option",{value:"card"},"Карта",-1)])],512),[[ct,s(f).method]])]),e("label",qt,[D(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>s(f).generateInvoice=a),type:"checkbox",disabled:s(f).method!=="bank_account"},null,8,Kt),[[ft,s(f).generateInvoice]]),t[26]||(t[26]=i(" Генерация счета (для ИП) ",-1))])]),s(_)?(d(),u("p",te,m(s(_)),1)):N("",!0),e("div",ee,[n(s(V),{variant:"outline",onClick:o},{default:l(()=>[...t[27]||(t[27]=[i("Отмена",-1)])]),_:1},8,["onClick"]),n(s(V),{onClick:dt},{default:l(()=>[...t[28]||(t[28]=[i("Подтвердить вывод",-1)])]),_:1})])])]),_:1},8,["modelValue"])]))}});export{ge as default};
