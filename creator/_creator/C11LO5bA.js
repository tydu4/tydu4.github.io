import{u as _e,G as be,o as $e,H as ke,a2 as z,l as c,$ as Me,t as h,R as s,b as B,C as w,D as e,N as L,J as me,T as ge,Q as he,U as j,V as ee,M as v,O as I,S as N,B as y,P as Q,X as G,W as Ce,ap as ye,aq as Pe,F as Fe,_ as Se,a1 as Te,a0 as Re}from"./CKBAJM5x.js";import H from"./C3SSI5uS.js";import{M as De}from"./DhMaaxFL.js";import{S as ze}from"./ptOWNeUL.js";import{c as xe}from"./rZUYJyJg.js";import{X as Qe}from"./DIVphGLv.js";import{u as Ee}from"./T--C6NLy.js";import"./CkYB-R1u.js";import"./c5FhCeC0.js";const Ne=xe("message-circle-question-mark",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const We=xe("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);const Ie=xe("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]),Le=globalThis.setInterval,we=u=>u==="check_in"||u==="live"||u==="afterparty"?u:u==="networking_game"?"live":"pre_event",le=u=>[...u].sort((d,r)=>{const p=new Date(d.created_at).getTime();return new Date(r.created_at).getTime()-p}),Ae=u=>{const d=_e(),r=h(()=>Number(s(u.eventId)||0)),p=h(()=>String(s(u.eventSlug)||"").trim()),i=u.pollingIntervalMs,l=h(()=>Number.isFinite(r.value)&&r.value>0),m=h(()=>p.value.length>0),g=c("pre_event"),_=c(!1),C=c(""),S=c([]),P=c(!1),f=c(""),o=c([]),a=c(0),R=c(!1),F=c(""),$=c(null),W=c([]),X=c(!1),T=c([]),D=c([]),J=c(!1),x=Me({prize:"VIP-ticket",pending:!1,running:!1,message:"",winner:null,notifyPending:!1}),U=c(!1);let K=null;const oe={pre_event:"Pre-Event",check_in:"Check-In",live:"Live",afterparty:"Afterparty"},ie=h(()=>a.value||o.value.length),A=h(()=>W.value.map(t=>({...t,isFavorite:D.value.includes(t.id),isHidden:T.value.includes(t.id)}))),Y=h(()=>{const t=A.value.filter(M=>!M.isHidden),n=t.filter(M=>M.isFavorite),b=t.filter(M=>!M.isFavorite);return[...n,...b]}),E=()=>{S.value=[],o.value=[],a.value=0,W.value=[],T.value=[],D.value=[],x.winner=null},te=async t=>{const n={content:t};return await d.apiFetch(`/api/v1/organizer/events/${r.value}/broadcast`,{method:"POST",baseURL:z("/api/v1/organizer/events"),body:n})},se=t=>{const n=o.value.findIndex(b=>b.id===t.id);if(n>=0){o.value.splice(n,1,t);return}o.value=[t,...o.value]},V=async(t=!1)=>{if(l.value){t||(P.value=!0);try{const n=await d.apiFetch(`/api/v1/organizer/events/${r.value}/broadcasts`,{baseURL:z("/api/v1/organizer/events"),query:{limit:10}});S.value=le(n?.items??[])}catch(n){console.error("[LiveDirector] Failed to refresh broadcasts",n)}finally{t||(P.value=!1)}}},ae=async(t=!1)=>{if(m.value){t||(R.value=!0);try{const n=await d.apiFetch(`/api/v1/events/${p.value}/questions`,{baseURL:z("/api/v1/events"),query:{limit:50,offset:0}});o.value=le(n?.items??[]),a.value=n?.total||o.value.length}catch(n){console.error("[LiveDirector] Failed to refresh questions",n)}finally{t||(R.value=!1)}}},ne=async(t=!1)=>{if(m.value){t||(X.value=!0);try{const n=await d.apiFetch(`/api/v1/events/${p.value}/wall`,{baseURL:z("/api/v1/events")});W.value=le(n?.items??[])}catch(n){console.error("[LiveDirector] Failed to refresh wall posts",n)}finally{t||(X.value=!1)}}},Z=async(t=!1)=>{if(l.value){t||(J.value=!0);try{const n=await d.apiFetch(`/api/v1/organizer/events/${r.value}/raffles`,{baseURL:z("/api/v1/organizer/events")}),b=le(n?.items??[]).find(M=>M.winner)?.winner||null;b&&(x.winner=b)}catch(n){console.error("[LiveDirector] Failed to refresh raffles",n)}finally{t||(J.value=!1)}}},O=async(t=!1)=>{if(!U.value){U.value=!0;try{await Promise.allSettled([V(t),ae(t),ne(t),Z(t)])}finally{U.value=!1}}},q=async t=>{if(!l.value||t===g.value)return!1;_.value=!0,C.value="";try{const n={mode:t},b=await d.apiFetch(`/api/v1/organizer/events/${r.value}/mode`,{method:"PATCH",baseURL:z("/api/v1/organizer/events"),body:n});return g.value=we(b?.new_mode||t),C.value=`Mode updated: ${oe[g.value]}`,!0}catch(n){return console.error("[LiveDirector] Failed to update mode",n),C.value="Could not update event mode.",!1}finally{_.value=!1}},de=async t=>{const n=t.trim();if(!n)return f.value="Message cannot be empty.",!1;if(!l.value)return f.value="Event id is not ready.",!1;P.value=!0,f.value="";try{return await te(n),await V(!0),!0}catch(b){return console.error("[LiveDirector] Failed to send broadcast",b),f.value="Could not send push notification.",!1}finally{P.value=!1}},ue=async(t,n)=>{const b=n.trim();if(!b)return F.value="Please enter an answer before sending.",!1;if(!l.value)return F.value="Event id is not ready.",!1;$.value=t,F.value="";try{const M={answer:b},re=await d.apiFetch(`/api/v1/organizer/events/${r.value}/questions/${t}/answer`,{method:"POST",baseURL:z("/api/v1/organizer/events"),body:M});return re&&se(re),F.value="Answer sent.",!0}catch(M){return console.error("[LiveDirector] Failed to answer question",M),F.value="Could not send answer.",!1}finally{$.value=null}},ce=async t=>{if(!l.value)return F.value="Event id is not ready.",!1;const n=o.value.find(b=>b.id===t);if(!n||n.is_public)return!0;$.value=t,F.value="";try{const b={answer:(n.answer||"Question approved for live stream.").trim()},M=await d.apiFetch(`/api/v1/organizer/events/${r.value}/questions/${t}/answer`,{method:"POST",baseURL:z("/api/v1/organizer/events"),body:b});return M&&se(M),F.value="Question published.",!0}catch(b){return console.error("[LiveDirector] Failed to publish question",b),F.value="Could not publish question.",!1}finally{$.value=null}},ve=t=>{if(T.value.includes(t)){T.value=T.value.filter(n=>n!==t);return}T.value=[...T.value,t]},fe=t=>{if(D.value.includes(t)){D.value=D.value.filter(n=>n!==t);return}D.value=[t,...D.value]},pe=async t=>{const n=t.trim();if(!n)return x.message="Enter a prize before running the raffle.",!1;if(!l.value)return x.message="Event id is not ready.",!1;x.prize=n,x.pending=!0,x.running=!0,x.message="";try{const b={prize:n},M=await d.apiFetch(`/api/v1/organizer/events/${r.value}/raffle`,{method:"POST",baseURL:z("/api/v1/organizer/events"),body:b});return x.winner=M?.winner||null,x.message=x.winner?"Winner selected.":"Raffle completed but no winner was returned.",await Z(!0),!0}catch(b){return console.error("[LiveDirector] Failed to run raffle",b),x.message="Could not run raffle.",!1}finally{x.pending=!1,window.setTimeout(()=>{x.running=!1},1200)}},k=async()=>{if(!l.value)return x.message="Event id is not ready.",!1;if(!x.winner)return x.message="Run a raffle first.",!1;x.notifyPending=!0,x.message="";try{const t=x.winner.full_name||x.winner.username||"Winner";return await te(`${t}, you won the raffle. Please come to the organizer desk.`),await V(!0),x.message="Winner notification sent.",!0}catch(t){return console.error("[LiveDirector] Failed to notify winner",t),x.message="Could not notify winner.",!1}finally{x.notifyPending=!1}};return be(()=>[r.value,p.value],async([t,n],b)=>{const[M,re]=b??[null,null];t===M&&n===re||(E(),!(!l.value&&!m.value)&&await O())},{immediate:!0}),u.initialMode!==void 0&&be(()=>s(u.initialMode),t=>{_.value||(g.value=we(t))},{immediate:!0}),$e(()=>{O(!0),K=Le(()=>{O(!0)},i)}),ke(()=>{K&&clearInterval(K)}),{currentMode:g,modePending:_,modeMessage:C,broadcasts:S,broadcastsPending:P,broadcastError:f,questions:o,questionsCount:ie,questionsPending:R,qaMessage:F,qaPendingQuestionId:$,wallPosts:W,wallPending:X,wallPostViews:A,visibleWallPosts:Y,hiddenWallPostIds:T,favoriteWallPostIds:D,rafflePending:J,raffleState:x,refreshPending:U,updateMode:q,sendBroadcast:de,answerQuestion:ue,publishQuestion:ce,toggleWallPostVisibility:ve,toggleWallPostFavorite:fe,runRaffle:pe,notifyWinner:k,refreshBroadcasts:V,refreshQuestions:ae,refreshWallPosts:ne,refreshRaffles:Z,refreshAllData:O}},Oe={class:"rounded-3xl border border-white/10 bg-slate-900/70 p-5"},Be={class:"flex items-center justify-between"},Ue={class:"mt-3 flex flex-wrap items-center gap-2"},Ve=["onClick"],qe={class:"mt-4 flex flex-wrap items-center justify-between gap-3"},He={class:"text-xs text-rose-300"},je={class:"mt-5 space-y-2"},Ge={key:0,class:"rounded-xl border border-dashed border-white/10 p-3 text-xs text-slate-500"},Xe={class:"text-sm text-slate-100"},Je={class:"mt-1 text-xs text-slate-500"},Ke=B({__name:"LiveBroadcastConsole",props:{broadcasts:{},sendHandler:{},pending:{type:Boolean,default:!1},errorMessage:{default:""}},setup(u){const d=u,r=["Start in 5 min","Doors open now","Main program starts"],p=c(""),i=c(!1),l=c(""),m=new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit"}),g=h(()=>d.pending||i.value),_=h(()=>d.errorMessage||l.value),C=f=>{p.value=f,l.value=""},S=async()=>{const f=p.value.trim();if(!f){l.value="Message cannot be empty.";return}i.value=!0,l.value="";try{if(!await d.sendHandler(f)){d.errorMessage||(l.value="Could not send push notification.");return}p.value=""}catch(o){console.error("[LiveBroadcastConsole] Failed to send push",o),l.value="Could not send push notification."}finally{i.value=!1}},P=f=>{const o=new Date(f);return Number.isNaN(o.getTime())?"--:--":m.format(o)};return(f,o)=>(y(),w("article",Oe,[e("div",Be,[o[1]||(o[1]=e("h2",{class:"text-lg font-semibold text-white"},"Broadcast Console",-1)),L(s(De),{class:"h-5 w-5 text-emerald-300"})]),me(e("textarea",{"onUpdate:modelValue":o[0]||(o[0]=a=>he(p)?p.value=a:null),rows:"4",placeholder:"Message to attendees",class:"mt-4 w-full rounded-2xl border border-white/10 bg-slate-950/70 px-4 py-3 text-sm text-slate-100 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/40"},null,512),[[ge,s(p)]]),e("div",Ue,[(y(),w(j,null,ee(r,a=>e("button",{key:a,class:"rounded-full border border-white/10 bg-slate-950/70 px-3 py-1 text-xs text-slate-300 hover:border-emerald-400/40 hover:text-emerald-200",onClick:R=>C(a)},v(a),9,Ve)),64))]),e("div",qe,[e("p",He,v(s(_)),1),L(s(H),{class:"gap-2",disabled:s(g),onClick:S},{default:I(()=>[Q(v(s(g)?"Sending...":"Send Push"),1)]),_:1},8,["disabled"])]),e("div",je,[o[2]||(o[2]=e("p",{class:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-500"},"Recent Push Notifications",-1)),u.broadcasts.length?N("",!0):(y(),w("div",Ge," No push notifications sent yet. ")),(y(!0),w(j,null,ee(u.broadcasts,a=>(y(),w("div",{key:a.id,class:"rounded-xl border border-white/10 bg-slate-950/60 px-4 py-3"},[e("p",Xe,v(a.content),1),e("p",Je,v(P(a.created_at)),1)]))),128))])]))}}),Ye=Object.assign(Ke,{__name:"EventsLiveBroadcastConsole"}),Ze={class:"rounded-3xl border border-white/10 bg-slate-900/70 p-5 backdrop-blur"},et={class:"flex flex-col gap-5 xl:flex-row xl:items-center xl:justify-between"},tt={class:"space-y-3"},st={class:"text-2xl font-bold text-white"},at={class:"flex flex-wrap items-center gap-3"},nt={class:"rounded-2xl border border-white/10 bg-slate-950/80 px-4 py-3"},rt={class:"text-xs uppercase tracking-[0.2em] text-slate-500"},lt={class:"mt-1 text-xl font-semibold text-emerald-300"},ot={class:"w-full max-w-xl space-y-2"},it={class:"grid grid-cols-2 gap-2 sm:grid-cols-4"},dt=["disabled","onClick"],ut=B({__name:"LiveHeader",props:{eventTitle:{default:"Event"},timerValue:{default:"--:--:--"},currentMode:{default:"pre_event"},loading:{type:Boolean,default:!1}},emits:["mode-change"],setup(u,{emit:d}){const r=u,p=d,i=[{value:"pre_event",label:"Pre-Event"},{value:"check_in",label:"Check-In"},{value:"live",label:"Live"},{value:"afterparty",label:"Afterparty"}],l=h(()=>r.currentMode==="live"?"Elapsed":"Countdown"),m=g=>{r.loading||r.currentMode===g||p("mode-change",g)};return(g,_)=>(y(),w("header",Ze,[e("div",et,[e("div",tt,[_[0]||(_[0]=e("p",{class:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-400"},"Live Director",-1)),e("h1",st,v(u.eventTitle),1),e("div",at,[e("div",nt,[e("p",rt,v(s(l)),1),e("p",lt,v(u.timerValue),1)])])]),e("div",ot,[_[1]||(_[1]=e("p",{class:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-400"},"Event Status",-1)),e("div",it,[(y(),w(j,null,ee(i,C=>e("button",{key:C.value,class:G(["rounded-xl border px-3 py-2 text-sm font-semibold transition",u.currentMode===C.value?"border-emerald-400/50 bg-emerald-500/20 text-emerald-100":"border-white/10 bg-slate-950/70 text-slate-300 hover:border-slate-500"]),disabled:u.loading,onClick:S=>m(C.value)},v(C.label),11,dt)),64))])])])]))}}),ct=Object.assign(ut,{__name:"EventsLiveHeader"}),vt={class:"rounded-3xl border border-white/10 bg-slate-900/70 p-5"},ft={class:"mt-4 grid gap-4 md:grid-cols-3"},pt={class:"rounded-2xl border border-white/10 bg-slate-950/60 p-4"},mt={class:"mt-3 space-y-1 text-xs text-slate-300"},gt={class:"font-semibold text-rose-300"},ht={class:"font-semibold text-sky-300"},xt={key:0,class:"mt-2 text-xs text-emerald-300"},bt={class:"rounded-2xl border border-white/10 bg-slate-950/60 p-4"},yt={class:"mt-3 text-xs text-slate-300"},wt={class:"rounded-2xl border border-white/10 bg-slate-950/60 p-4"},_t={class:"mt-3 text-xs text-slate-300"},$t=B({__name:"LiveInteractiveWidget",props:{questionsCount:{},raffleWinner:{}},emits:["open-raffle","toggle-qa"],setup(u,{emit:d}){const r=u,p=d,i=c(!1),l=c(!1),m=c(40),g=c(35),_=c(""),C=h(()=>r.raffleWinner?.full_name||r.raffleWinner?.username||"No winner yet"),S=()=>{l.value||(l.value=!0,m.value+=Math.floor(Math.random()*3),g.value+=Math.floor(Math.random()*3),_.value="Color Match is running.",window.setTimeout(()=>{l.value=!1,_.value=""},1400))},P=()=>{i.value=!i.value,p("toggle-qa",i.value)},f=()=>{p("open-raffle")};return(o,a)=>(y(),w("article",vt,[a[7]||(a[7]=e("h2",{class:"text-lg font-semibold text-white"},"Interactive Widgets",-1)),e("div",ft,[e("div",pt,[a[3]||(a[3]=e("p",{class:"text-xs uppercase tracking-[0.2em] text-slate-500"},"Color Match",-1)),L(s(H),{class:"mt-3 w-full gap-2",onClick:S},{default:I(()=>[L(s(ze),{class:"h-4 w-4"}),a[0]||(a[0]=Q(" Start Game ",-1))]),_:1}),e("div",mt,[e("p",null,[a[1]||(a[1]=Q("Red: ",-1)),e("span",gt,v(s(m)),1)]),e("p",null,[a[2]||(a[2]=Q("Blue: ",-1)),e("span",ht,v(s(g)),1)])]),s(l)||s(_)?(y(),w("p",xt,v(s(_)||"Game is live."),1)):N("",!0)]),e("div",bt,[a[5]||(a[5]=e("p",{class:"text-xs uppercase tracking-[0.2em] text-slate-500"},"Raffle",-1)),L(s(H),{class:"mt-3 w-full gap-2",onClick:f},{default:I(()=>[L(s(Ie),{class:"h-4 w-4"}),a[4]||(a[4]=Q(" Open Raffle ",-1))]),_:1}),e("p",yt,"Winner: "+v(s(C)),1)]),e("div",wt,[a[6]||(a[6]=e("p",{class:"text-xs uppercase tracking-[0.2em] text-slate-500"},"Q&A",-1)),L(s(H),{variant:"outline",class:"mt-3 w-full gap-2",onClick:P},{default:I(()=>[L(s(Ne),{class:"h-4 w-4"}),Q(" "+v(s(i)?"Hide Q&A":"Open Q&A"),1)]),_:1}),e("p",_t,"Questions: "+v(u.questionsCount),1)])])]))}}),kt=Object.assign($t,{__name:"EventsLiveInteractiveWidget"}),Mt={class:"space-y-3 rounded-3xl border border-white/10 bg-slate-900/70 p-5"},Ct={class:"flex items-center justify-between"},Lt={class:"text-xs uppercase tracking-[0.2em] text-slate-500"},Pt={key:0,class:"rounded-2xl border border-dashed border-white/10 p-4 text-sm text-slate-500"},Ft={class:"flex items-start justify-between gap-3"},St={class:"text-sm font-semibold text-slate-100"},Tt={class:"mt-1 text-sm text-slate-300"},Rt={class:"mt-1 text-xs text-slate-500"},Dt=["onUpdate:modelValue"],zt={class:"mt-3 grid gap-2 sm:grid-cols-2"},Qt=["disabled","onClick"],Et=["disabled","onClick"],Nt=B({__name:"LiveQAConsole",props:{questions:{},answerHandler:{},publishHandler:{},statusMessage:{default:""},pendingQuestionId:{default:null}},setup(u){const d=u,r=Me({}),p=c(null),i=c(""),l=new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit"}),m=h(()=>d.pendingQuestionId??p.value),g=h(()=>d.statusMessage||i.value),_=h(()=>g.value.toLowerCase().includes("could not")),C=f=>{const o=new Date(f);return Number.isNaN(o.getTime())?"--:--":l.format(o)},S=async f=>{const o=(r[f]||"").trim();if(!o){i.value="Please add an answer first.";return}p.value=f,i.value="";try{if(!await d.answerHandler(f,o)){d.statusMessage||(i.value="Could not send answer.");return}r[f]="",i.value="Answer sent."}catch(a){console.error("[LiveQAConsole] Failed to send answer",a),i.value="Could not send answer."}finally{p.value=null}},P=async f=>{p.value=f,i.value="";try{if(!await d.publishHandler(f)){d.statusMessage||(i.value="Could not publish question.");return}i.value="Question published."}catch(o){console.error("[LiveQAConsole] Failed to publish question",o),i.value="Could not publish question."}finally{p.value=null}};return(f,o)=>(y(),w("article",Mt,[e("div",Ct,[o[0]||(o[0]=e("h2",{class:"text-lg font-semibold text-white"},"Q&A Console",-1)),e("span",Lt,v(u.questions.length)+" items",1)]),e("p",{class:G(["min-h-[1.25rem] text-xs",s(_)?"text-rose-300":"text-emerald-300"])},v(s(g)),3),u.questions.length?N("",!0):(y(),w("div",Pt," There are no attendee questions yet. ")),(y(!0),w(j,null,ee(u.questions,a=>(y(),w("div",{key:a.id,class:"rounded-2xl border border-white/10 bg-slate-950/60 p-4"},[e("div",Ft,[e("div",null,[e("p",St,v(a.user?.full_name||a.user?.username||"Attendee"),1),e("p",Tt,v(a.question),1),e("p",Rt,v(C(a.created_at)),1)]),e("span",{class:G(["rounded-full border px-2 py-1 text-xs",a.is_public?"border-emerald-400/50 bg-emerald-500/15 text-emerald-200":"border-white/15 text-slate-400"])},v(a.is_public?"Public":"Private"),3)]),me(e("textarea",{"onUpdate:modelValue":R=>s(r)[a.id]=R,rows:"2",placeholder:"Answer text",class:"mt-3 w-full rounded-xl border border-white/10 bg-slate-900/70 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/40"},null,8,Dt),[[ge,s(r)[a.id]]]),e("div",zt,[e("button",{class:"rounded-xl border border-emerald-400/30 bg-emerald-500/15 px-3 py-2 text-sm font-semibold text-emerald-200 hover:bg-emerald-500/20 disabled:cursor-not-allowed disabled:opacity-60",disabled:s(m)===a.id||!(s(r)[a.id]||"").trim(),onClick:R=>S(a.id)},v(s(m)===a.id?"Sending...":"Answer"),9,Qt),e("button",{class:"rounded-xl border border-sky-400/30 bg-sky-500/15 px-3 py-2 text-sm font-semibold text-sky-200 hover:bg-sky-500/20 disabled:cursor-not-allowed disabled:opacity-60",disabled:s(m)===a.id||a.is_public,onClick:R=>P(a.id)},v(a.is_public?"Published":"Publish"),9,Et)])]))),128))]))}}),Wt=Object.assign(Nt,{__name:"EventsLiveQAConsole"}),It={class:"flex items-center justify-between"},At={class:"mt-4 space-y-2"},Ot={class:"mt-4 flex justify-center"},Bt={key:0,class:"mt-3 flex items-center gap-3 rounded-2xl border border-white/10 bg-slate-950/70 px-3 py-2"},Ut=["src","alt"],Vt={key:1,class:"flex h-12 w-12 items-center justify-center rounded-full bg-emerald-500/25 text-lg font-semibold text-emerald-200"},qt={class:"text-sm font-semibold text-slate-100"},Ht={class:"mt-4"},jt=B({__name:"LiveRaffleModal",props:{isOpen:{type:Boolean},winner:{},runHandler:{},pending:{type:Boolean,default:!1},running:{type:Boolean,default:!1},message:{default:""}},emits:["update:isOpen"],setup(u,{emit:d}){const r=u,p=d,i=c("VIP-ticket"),l=c(!1),m=c(!1),g=c(""),_=h(()=>r.pending||l.value),C=h(()=>r.running||m.value),S=h(()=>r.message||g.value),P=h(()=>S.value.toLowerCase().includes("could not")),f=h(()=>r.winner?.full_name||r.winner?.username||"Winner"),o=h(()=>f.value.trim().charAt(0).toUpperCase()||"W"),a=()=>{p("update:isOpen",!1)},R=async()=>{const F=i.value.trim();if(!F){g.value="Enter a prize before running raffle.";return}l.value=!0,m.value=!0,g.value="";try{if(!await r.runHandler(F)){r.message||(g.value="Could not run raffle.");return}g.value="Raffle completed."}catch($){console.error("[LiveRaffleModal] Failed to run raffle",$),g.value="Could not run raffle."}finally{l.value=!1,window.setTimeout(()=>{m.value=!1},1200)}};return(F,$)=>(y(),Ce(Pe,{to:"body"},[L(ye,{"enter-active-class":"transition-opacity duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-opacity duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:I(()=>[r.isOpen?(y(),w("div",{key:0,class:"fixed inset-0 z-50 bg-black/70",onClick:a})):N("",!0)]),_:1}),L(ye,{"enter-active-class":"transition-transform duration-300 ease-out","enter-from-class":"scale-95 opacity-0","enter-to-class":"scale-100 opacity-100","leave-active-class":"transition-transform duration-200 ease-in","leave-from-class":"scale-100 opacity-100","leave-to-class":"scale-95 opacity-0"},{default:I(()=>[r.isOpen?(y(),w("div",{key:0,class:"fixed left-1/2 top-1/2 z-50 w-[min(92vw,430px)] -translate-x-1/2 -translate-y-1/2 rounded-3xl border border-white/10 bg-slate-900 p-5 text-slate-100",onClick:$[1]||($[1]=Fe(()=>{},["stop"]))},[e("div",It,[$[2]||($[2]=e("h3",{class:"text-lg font-semibold"},"Raffle",-1)),L(s(H),{variant:"ghost",size:"icon",class:"rounded-full",onClick:a},{default:I(()=>[L(s(Qe),{class:"h-4 w-4"})]),_:1})]),$[5]||($[5]=e("p",{class:"mt-2 text-sm text-slate-400"},"Spin the drum and select a winner during the event.",-1)),e("div",At,[$[3]||($[3]=e("p",{class:"text-xs uppercase tracking-[0.2em] text-slate-500"},"Prize",-1)),me(e("input",{"onUpdate:modelValue":$[0]||($[0]=W=>he(i)?i.value=W:null),type:"text",placeholder:"For example, VIP pass",class:"w-full rounded-xl border border-white/10 bg-slate-950/70 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-emerald-500/40"},null,512),[[ge,s(i)]])]),e("div",Ot,[e("div",{class:G(["raffle-drum",{"raffle-drum--spin":s(C)}])},"DR",2)]),e("p",{class:G(["mt-3 min-h-[1.25rem] text-center text-xs",s(P)?"text-rose-300":"text-emerald-300"])},v(s(S)),3),r.winner?(y(),w("div",Bt,[r.winner.avatar_url?(y(),w("img",{key:0,src:r.winner.avatar_url,alt:s(f),class:"h-12 w-12 rounded-full object-cover"},null,8,Ut)):(y(),w("div",Vt,v(s(o)),1)),e("div",null,[$[4]||($[4]=e("p",{class:"text-xs text-slate-400"},"Winner",-1)),e("p",qt,v(s(f)),1)])])):N("",!0),e("div",Ht,[L(s(H),{class:"w-full",disabled:s(_),onClick:R},{default:I(()=>[Q(v(s(_)?"Running...":"Run Raffle"),1)]),_:1},8,["disabled"])])])):N("",!0)]),_:1})]))}}),Gt=Object.assign(Se(jt,[["__scopeId","data-v-4ee7e60f"]]),{__name:"EventsLiveRaffleModal"}),Xt={class:"rounded-3xl border border-white/10 bg-slate-900/70 p-5"},Jt={class:"mt-4 max-h-[62vh] space-y-3 overflow-y-auto pr-1"},Kt={key:0,class:"rounded-2xl border border-dashed border-white/10 p-4 text-sm text-slate-500"},Yt={class:"flex items-start justify-between gap-3"},Zt={class:"min-w-0"},es={class:"text-sm font-semibold text-slate-100"},ts={class:"mt-1 break-words text-sm text-slate-300"},ss={class:"mt-2 text-xs text-slate-500"},as={class:"flex flex-col gap-2"},ns=["onClick"],rs=["onClick"],ls={key:0,class:"mt-2 flex items-center gap-1 text-xs text-amber-300"},os=B({__name:"LiveWallModeration",props:{posts:{},toggleVisibility:{type:Function},toggleFavorite:{type:Function}},setup(u){const d=u,r=new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit"}),p=i=>{const l=new Date(i);return Number.isNaN(l.getTime())?"--:--":r.format(l)};return(i,l)=>(y(),w("aside",Xt,[l[1]||(l[1]=e("div",{class:"flex items-center justify-between"},[e("h2",{class:"text-lg font-semibold text-white"},"Wall Feed"),e("span",{class:"text-xs uppercase tracking-[0.2em] text-slate-500"},"Moderation")],-1)),e("div",Jt,[d.posts.length?N("",!0):(y(),w("div",Kt," No posts yet. ")),(y(!0),w(j,null,ee(d.posts,m=>(y(),w("article",{key:m.id,class:"rounded-2xl border border-white/10 bg-slate-950/70 p-4"},[e("div",Yt,[e("div",Zt,[e("p",es,v(m.user?.full_name||m.user?.username||"Attendee"),1),e("p",ts,v(m.content),1),e("p",ss,v(p(m.created_at)),1)]),e("div",as,[e("button",{class:"rounded-full border border-white/10 px-3 py-1 text-xs text-slate-300 hover:border-rose-400/40 hover:text-rose-300",onClick:g=>d.toggleVisibility(m.id)}," Hide ",8,ns),e("button",{class:"rounded-full border border-white/10 px-3 py-1 text-xs text-slate-300 hover:border-amber-400/40 hover:text-amber-300",onClick:g=>d.toggleFavorite(m.id)},v(m.isFavorite?"Unstar":"Star"),9,rs)])]),m.isFavorite?(y(),w("div",ls,[L(s(We),{class:"h-3 w-3"}),l[0]||(l[0]=Q(" Starred ",-1))])):N("",!0)]))),128))])]))}}),is=Object.assign(os,{__name:"EventsLiveWallModeration"}),ds={class:"dark min-h-screen bg-slate-950 text-slate-100"},us={class:"mx-auto flex w-full max-w-7xl flex-col gap-6 px-4 py-6 sm:px-6 lg:px-8"},cs={class:"rounded-2xl border border-white/10 bg-slate-900/50 px-4 py-3 text-xs text-slate-400"},vs={class:"text-slate-200"},fs={class:"mt-1"},ps={class:"text-slate-200"},ms={class:"grid gap-6 xl:grid-cols-3"},gs={class:"space-y-6 xl:col-span-2"},Cs=B({__name:"index",setup(u){const d=_e(),{user:r}=Te(d),p=Re(),i=h(()=>Number(p.params.id||0)),{data:l,pending:m}=Ee("organizer-live-director-event",async()=>{if(!i.value||Number.isNaN(i.value))return null;try{return await d.apiFetch(`/api/v1/events/${i.value}`,{baseURL:z("/api/v1/events")})}catch(k){return console.error("[LiveDirector] Failed to fetch event",k),null}},{watch:[i],default:()=>null}),g=h(()=>l.value?.title||`Event #${i.value||"-"}`),_=h(()=>l.value?.slug||String(p.params.id||"")),{currentMode:C,modePending:S,modeMessage:P,broadcasts:f,broadcastsPending:o,broadcastError:a,questions:R,questionsCount:F,qaMessage:$,qaPendingQuestionId:W,visibleWallPosts:X,raffleState:T,updateMode:D,sendBroadcast:J,answerQuestion:x,publishQuestion:U,toggleWallPostVisibility:K,toggleWallPostFavorite:oe,runRaffle:ie}=Ae({eventId:i,eventSlug:_,initialMode:h(()=>l.value?.current_mode),pollingIntervalMs:8e3}),A=c(Date.now());let Y=null;const E=h(()=>{const k=l.value?.occurrences?.[0]?.start_time;if(!k)return null;const t=new Date(k).getTime();return Number.isNaN(t)?null:t}),te=h(()=>E.value===null?!1:A.value>=E.value),se=new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"}),V=h(()=>E.value===null?"Start time is not set":se.format(new Date(E.value))),ae=k=>{const t=Math.max(0,Math.floor(k/1e3)),n=Math.floor(t/3600),b=Math.floor(t%3600/60),M=t%60;return`${String(n).padStart(2,"0")}:${String(b).padStart(2,"0")}:${String(M).padStart(2,"0")}`},ne=h(()=>{if(E.value===null)return"--:--:--";const k=te.value?A.value-E.value:E.value-A.value;return ae(k)}),Z=h(()=>m.value||S.value),O=c(!1),q=c(!1),de=async k=>{await D(k)},ue=async k=>await J(k),ce=async(k,t)=>await x(k,t),ve=async k=>await U(k),fe=()=>{q.value=!0},pe=k=>{O.value=k};return $e(()=>{Y=Le(()=>{A.value=Date.now()},1e3)}),ke(()=>{Y&&clearInterval(Y)}),(k,t)=>(y(),w(j,null,[e("div",ds,[e("div",us,[L(ct,{"event-title":s(g),"timer-value":s(ne),"current-mode":s(C),loading:s(Z),onModeChange:de},null,8,["event-title","timer-value","current-mode","loading"]),e("div",cs,[e("p",null,[t[1]||(t[1]=Q(" Organizer: ",-1)),e("span",vs,v(s(r)?.full_name||s(r)?.username||"-"),1)]),e("p",fs,[t[2]||(t[2]=Q(" Event starts: ",-1)),e("span",ps,v(s(V)),1)]),e("p",{class:G(["mt-1",s(P).includes("Could not")?"text-rose-300":"text-emerald-300"])},v(s(P)),3)]),e("section",ms,[e("div",gs,[L(Ye,{broadcasts:s(f),"send-handler":ue,pending:s(o),"error-message":s(a)},null,8,["broadcasts","pending","error-message"]),L(kt,{"questions-count":s(F),"raffle-winner":s(T).winner,onOpenRaffle:fe,onToggleQa:pe},null,8,["questions-count","raffle-winner"]),s(O)?(y(),Ce(Wt,{key:0,questions:s(R),"answer-handler":ce,"publish-handler":ve,"status-message":s($),"pending-question-id":s(W)},null,8,["questions","status-message","pending-question-id"])):N("",!0)]),L(is,{posts:s(X),"toggle-visibility":s(K),"toggle-favorite":s(oe)},null,8,["posts","toggle-visibility","toggle-favorite"])])])]),L(Gt,{"is-open":s(q),"onUpdate:isOpen":t[0]||(t[0]=n=>he(q)?q.value=n:null),winner:s(T).winner,"run-handler":s(ie),pending:s(T).pending,running:s(T).running,message:s(T).message},null,8,["is-open","winner","run-handler","pending","running","message"])],64))}});export{Cs as default};
