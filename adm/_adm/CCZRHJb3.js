import{f as Q,T as q,L as o,O as t,F as c,K as n,H as r,M as y,J as f,ai as ce,a3 as pe,R as W,G as p,S as M,v as k,y as L,P as N,Q as G,W as Ve,c as Ke,X as J,N as fe,k as Je,$ as Xe}from"./Bdjb0SXm.js";import I from"./B4TyZ_bU.js";import"./cRrWWQur.js";import"./Da0WQd-O.js";import"./BEYAt5ls.js";import"./DS_fG_uV.js";import Ye from"./DeHUBOuf.js";import Ze from"./MI7OGpUw.js";import et from"./BKfwxZk3.js";import X from"./C60XlcZO.js";import Y from"./CKmkznge.js";import B from"./B0YsM2uZ.js";import tt from"./Bh3fyw7B.js";import Z from"./BsWIP-yW.js";import ee from"./BNLw-KlI.js";import te from"./B4yhBorQ.js";import"./BcuCH1ZM.js";import se from"./Bkl1Gi2Q.js";import"./B3ikXpdR.js";import{u as re}from"./DI7PMaLP.js";import"./CkYB-R1u.js";import"./c5FhCeC0.js";import"./CL3jLyeF.js";const st=["onKeydown"],at={class:"text-sm font-medium"},rt={key:0,class:"text-xs text-red-400"},ot=Q({__name:"DbDumpBlock",props:{downloadingDump:{type:Boolean},uploadingDump:{type:Boolean},destructiveDisabled:{type:Boolean}},emits:["download-db","restore-file"],setup(T,{emit:b}){const u=T,$=b,x=k(!1),i=k(""),R=k(null),_=L(()=>u.uploadingDump||u.destructiveDisabled),C=()=>{_.value||R.value?.click()},A=m=>{if(m){if(_.value){i.value="Another DB operation is in progress. Restore is temporarily locked.";return}if(!m.name.toLowerCase().endsWith(".sql")){i.value="Only .sql files are allowed.";return}i.value="",$("restore-file",m)}},O=m=>{const h=m.target;A(h?.files?.[0]),h&&(h.value="")},D=m=>{m.preventDefault(),!_.value&&(x.value=!0)},l=m=>{m.preventDefault(),x.value=!1},g=m=>{m.preventDefault(),x.value=!1,!_.value&&A(m.dataTransfer?.files?.[0])};return(m,h)=>(c(),q(t(Z),{class:"rounded-2xl border-slate-800 bg-slate-900/80 shadow-lg shadow-slate-950/40"},{default:o(()=>[n(t(ee),{class:"flex flex-row items-start justify-between gap-4 space-y-0 border-b border-slate-800"},{default:o(()=>[r("div",null,[h[2]||(h[2]=r("p",{class:"text-xs uppercase tracking-[0.2em] text-slate-500"},"Dump",-1)),n(t(te),{class:"mt-1 text-lg text-slate-100"},{default:o(()=>[...h[1]||(h[1]=[y("Import / Export",-1)])]),_:1})]),n(t(I),{size:"sm",variant:"outline",class:"border-slate-700 bg-slate-900 text-slate-200 hover:bg-slate-800",disabled:u.downloadingDump,onClick:h[0]||(h[0]=V=>$("download-db"))},{default:o(()=>[y(f(u.downloadingDump?"Preparing...":"Download DB"),1)]),_:1},8,["disabled"])]),_:1}),n(t(se),{class:"space-y-3 pt-4"},{default:o(()=>[r("div",{role:"button",tabindex:"0",class:W(["rounded-xl border-2 border-dashed px-4 py-8 text-center transition",t(_)?"cursor-not-allowed border-slate-800 bg-slate-950 text-slate-500 opacity-70":t(x)?"border-orange-400 bg-orange-500/10 text-orange-200":"border-slate-700 bg-slate-950 text-slate-300"]),onClick:C,onKeydown:[ce(pe(C,["prevent"]),["enter"]),ce(pe(C,["prevent"]),["space"])],onDragover:D,onDragleave:l,onDrop:g},[r("p",at,f(u.uploadingDump?"Uploading SQL file...":u.destructiveDisabled?"Restore is locked while another DB operation runs":"Drop SQL file here or click to upload"),1),h[3]||(h[3]=r("p",{class:"mt-1 text-xs text-slate-500"},"Restore from file",-1))],42,st),r("input",{ref_key:"fileInput",ref:R,type:"file",class:"hidden",accept:".sql,application/sql,text/plain",onChange:O},null,544),t(i)?(c(),p("p",rt,f(t(i)),1)):M("",!0)]),_:1})]),_:1}))}}),nt={class:"rounded-lg border border-slate-800 bg-slate-950 px-3 py-2"},lt={key:0,class:"mt-2 h-4 w-48 animate-pulse rounded bg-slate-800"},it={key:1,class:"mt-1 font-mono text-sm text-slate-100"},dt=Q({__name:"DbMigrationsBlock",props:{currentRevision:{},upgradingHead:{type:Boolean},loadingRevision:{type:Boolean},destructiveDisabled:{type:Boolean}},emits:["upgrade-head"],setup(T,{emit:b}){const u=T,$=b;return(x,i)=>(c(),q(t(Z),{class:"rounded-2xl border-slate-800 bg-slate-900/80 shadow-lg shadow-slate-950/40"},{default:o(()=>[n(t(ee),{class:"flex flex-row items-start justify-between gap-4 space-y-0 border-b border-slate-800"},{default:o(()=>[r("div",null,[i[2]||(i[2]=r("p",{class:"text-xs uppercase tracking-[0.2em] text-slate-500"},"Alembic",-1)),n(t(te),{class:"mt-1 text-lg text-slate-100"},{default:o(()=>[...i[1]||(i[1]=[y("Migrations",-1)])]),_:1})]),n(t(I),{size:"sm",class:"bg-orange-600 text-white hover:bg-orange-700",disabled:u.upgradingHead||u.destructiveDisabled,onClick:i[0]||(i[0]=R=>$("upgrade-head"))},{default:o(()=>[y(f(u.upgradingHead?"Applying...":"Upgrade Head"),1)]),_:1},8,["disabled"])]),_:1}),n(t(se),{class:"space-y-3 pt-4"},{default:o(()=>[r("div",nt,[i[3]||(i[3]=r("p",{class:"text-[11px] uppercase tracking-[0.2em] text-slate-500"},"Current Revision",-1)),u.loadingRevision?(c(),p("p",lt)):(c(),p("p",it,f(u.currentRevision),1))]),i[4]||(i[4]=r("p",{class:"text-xs text-amber-300"}," Apply with caution. Upgrading schema can impact active traffic. ",-1))]),_:1})]),_:1}))}}),ut={class:"text-xs uppercase tracking-[0.2em] text-slate-400"},ct={key:0,class:"space-y-2"},pt={key:1,class:"m-0 whitespace-pre-wrap"},me=Q({__name:"DbOperationLogBlock",props:{title:{},caption:{},logs:{},pending:{type:Boolean},emptyMessage:{},variant:{}},setup(T){const b=T,u=L(()=>b.logs.length===0?[b.emptyMessage||"[--:--:--] Waiting for operations..."]:b.logs),$=L(()=>b.variant==="error"?"border-red-500/30 bg-red-950/70 text-red-100":"border-slate-800 bg-slate-900 text-slate-100"),x=L(()=>b.variant==="error"?"bg-slate-950 text-red-200":"bg-slate-950 text-emerald-300");return(i,R)=>(c(),q(t(Z),{class:"overflow-hidden rounded-2xl border-slate-800 bg-slate-900/80 shadow-lg shadow-slate-950/40"},{default:o(()=>[n(t(ee),{class:W(["border-b",t($)])},{default:o(()=>[r("p",ut,f(b.caption||"Console"),1),n(t(te),{class:"text-lg text-white"},{default:o(()=>[y(f(b.title||"Operation Logs"),1)]),_:1})]),_:1},8,["class"]),n(t(se),{class:"p-0"},{default:o(()=>[r("div",{class:W(["max-h-[280px] overflow-auto p-4 font-mono text-xs leading-relaxed",t(x)])},[b.pending?(c(),p("div",ct,[(c(),p(N,null,G(5,_=>r("div",{key:`log-skeleton-${_}`,class:"h-4 animate-pulse rounded bg-slate-800"})),64))])):(c(),p("pre",pt,f(t(u).join(`
`)),1))],2)]),_:1})]),_:1}))}}),ft={class:"space-y-4"},mt={class:"mt-1 font-mono text-sm text-foreground"},gt={class:"flex items-center justify-end gap-2"},bt=Q({__name:"DbSnapshotsBlock",props:{snapshots:{},loading:{type:Boolean},refreshing:{type:Boolean},restoringSnapshotId:{},destructiveDisabled:{type:Boolean}},emits:["refresh-snapshots","restore-snapshot"],setup(T,{emit:b}){const u=T,$=b,x=k(!1),i=k(null),R=D=>D==="ready"?"border-emerald-400/30 bg-emerald-500/10 text-emerald-300":"border-red-400/30 bg-red-500/10 text-red-300",_=D=>D==="ready"?"Ready":"Failed",C=D=>{u.destructiveDisabled||(i.value=D,x.value=!0)},A=()=>{x.value=!1,i.value=null},O=()=>{i.value&&($("restore-snapshot",i.value.filename),A())};return(D,l)=>(c(),p(N,null,[n(t(Z),{class:"rounded-2xl border-slate-800 bg-slate-900/80 shadow-lg shadow-slate-950/40"},{default:o(()=>[n(t(ee),{class:"flex flex-row items-start justify-between gap-4 space-y-0 border-b border-slate-800"},{default:o(()=>[r("div",null,[l[3]||(l[3]=r("p",{class:"text-xs uppercase tracking-[0.2em] text-slate-500"},"Snapshots",-1)),n(t(te),{class:"mt-1 text-lg text-slate-100"},{default:o(()=>[...l[2]||(l[2]=[y("Backups",-1)])]),_:1})]),n(t(I),{size:"sm",variant:"outline",class:"border-slate-700 bg-slate-900 text-slate-200 hover:bg-slate-800",disabled:u.refreshing,onClick:l[0]||(l[0]=g=>$("refresh-snapshots"))},{default:o(()=>[y(f(u.refreshing?"Refreshing...":"Refresh"),1)]),_:1},8,["disabled"])]),_:1}),n(t(se),{class:"pt-4"},{default:o(()=>[n(t(Ye),null,{default:o(()=>[n(t(Ze),null,{default:o(()=>[n(t(X),{class:"border-slate-800"},{default:o(()=>[n(t(Y),{class:"text-slate-400"},{default:o(()=>[...l[4]||(l[4]=[y("Date",-1)])]),_:1}),n(t(Y),{class:"text-slate-400"},{default:o(()=>[...l[5]||(l[5]=[y("Size",-1)])]),_:1}),n(t(Y),{class:"text-slate-400"},{default:o(()=>[...l[6]||(l[6]=[y("Status",-1)])]),_:1}),n(t(Y),{class:"text-right text-slate-400"},{default:o(()=>[...l[7]||(l[7]=[y("Action",-1)])]),_:1})]),_:1})]),_:1}),n(t(et),null,{default:o(()=>[u.loading?(c(),p(N,{key:0},G(4,g=>n(t(X),{key:`snapshot-skeleton-${g}`,class:"border-slate-800"},{default:o(()=>[n(t(B),null,{default:o(()=>[...l[8]||(l[8]=[r("div",{class:"h-3 animate-pulse rounded bg-slate-800"},null,-1)])]),_:1}),n(t(B),null,{default:o(()=>[...l[9]||(l[9]=[r("div",{class:"h-3 animate-pulse rounded bg-slate-800"},null,-1)])]),_:1}),n(t(B),null,{default:o(()=>[...l[10]||(l[10]=[r("div",{class:"h-3 w-16 animate-pulse rounded bg-slate-800"},null,-1)])]),_:1}),n(t(B),null,{default:o(()=>[...l[11]||(l[11]=[r("div",{class:"ml-auto h-7 w-20 animate-pulse rounded bg-slate-800"},null,-1)])]),_:1})]),_:1})),64)):u.snapshots.length===0?(c(),q(t(X),{key:1,class:"border-slate-800"},{default:o(()=>[n(t(B),{colspan:4,class:"py-6 text-center text-sm text-slate-500"},{default:o(()=>[...l[12]||(l[12]=[y(" No snapshots yet. ",-1)])]),_:1})]),_:1})):(c(!0),p(N,{key:2},G(u.snapshots,g=>(c(),q(t(X),{key:g.filename,class:"border-slate-800"},{default:o(()=>[n(t(B),{class:"text-xs text-slate-300"},{default:o(()=>[y(f(g.createdAt),1)]),_:2},1024),n(t(B),{class:"text-xs text-slate-300"},{default:o(()=>[y(f(g.size),1)]),_:2},1024),n(t(B),null,{default:o(()=>[r("span",{class:W(["inline-flex rounded-full border px-2 py-0.5 text-[11px] font-medium",R(g.status)])},f(_(g.status)),3)]),_:2},1024),n(t(B),{class:"text-right"},{default:o(()=>[n(t(I),{size:"sm",class:"bg-red-600 text-white hover:bg-red-700",disabled:u.restoringSnapshotId===g.filename||u.destructiveDisabled||g.status!=="ready",onClick:m=>C(g)},{default:o(()=>[y(f(u.restoringSnapshotId===g.filename?"Restoring...":"Restore"),1)]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),n(t(tt),{modelValue:t(x),"onUpdate:modelValue":l[1]||(l[1]=g=>Ve(x)?x.value=g:null)},{default:o(()=>[r("div",ft,[r("div",null,[l[13]||(l[13]=r("p",{class:"text-xs uppercase tracking-[0.2em] text-red-500"},"Confirm Restore",-1)),l[14]||(l[14]=r("h3",{class:"mt-2 text-lg font-semibold text-foreground"},"Restore Snapshot",-1)),l[15]||(l[15]=r("p",{class:"mt-2 text-sm text-muted-foreground"}," This will overwrite current database state. ",-1)),r("p",mt,f(t(i)?.filename||"-"),1)]),r("div",gt,[n(t(I),{variant:"outline",onClick:A},{default:o(()=>[...l[16]||(l[16]=[y("Cancel",-1)])]),_:1}),n(t(I),{class:"bg-red-600 text-white hover:bg-red-700",disabled:u.destructiveDisabled,onClick:O},{default:o(()=>[...l[17]||(l[17]=[y(" Restore Snapshot ",-1)])]),_:1},8,["disabled"])])])]),_:1},8,["modelValue"])],64))}}),xt=globalThis.setInterval,vt={key:0,class:"rounded-2xl border border-slate-800 bg-slate-900/70 p-4 text-sm text-slate-300"},ht={key:1,class:"rounded-2xl border border-red-900/70 bg-red-950/40 p-4 text-sm text-red-200"},yt={key:2,class:"space-y-6"},wt={class:"grid gap-6 xl:grid-cols-2"},_t={class:"rounded-2xl border border-slate-800 bg-slate-900/80 shadow-lg shadow-slate-950/40"},kt={class:"flex items-center justify-between gap-4 border-b border-slate-800 px-4 py-3"},Dt={class:"text-xs text-slate-500"},St=["disabled"],Rt={class:"max-h-[280px] overflow-auto p-4"},$t={key:0,class:"space-y-2"},Ct={key:1,class:"space-y-2"},At={class:"font-mono text-[11px] text-slate-500"},Lt={key:2,class:"text-xs text-slate-500"},Bt={key:0,class:"rounded-xl border border-red-900/70 bg-red-950/40 px-4 py-3 text-xs text-red-200"},Tt={key:1,class:"rounded-xl border border-red-900/70 bg-red-950/40 px-4 py-3 text-xs text-red-200"},Ot={key:2,class:"rounded-xl border border-red-900/70 bg-red-950/40 px-4 py-3 text-xs text-red-200"},Pt={key:3,class:"fixed inset-0 z-[60] flex items-center justify-center bg-slate-950/80 backdrop-blur-sm"},Ut={class:"rounded-2xl border border-orange-400/40 bg-slate-900 px-6 py-5 shadow-2xl shadow-orange-950/40"},It={class:"mt-2 text-sm text-slate-100"},ge="/api/v1/admin/database/snapshots",be="/api/v1/admin/database/migrations/current",Nt="/api/v1/admin/database/migrations/upgrade",zt="/api/v1/admin/database/dump/download",Ft="/api/v1/admin/database/dump/upload",xe="/api/v1/admin/database/operations/logs",ds=Q({__name:"orchestration",setup(T){const b=Ke(),u=L(()=>!!b.user),$=L(()=>b.user?.role==="admin"),x=k(["[00:00:00] DB orchestration dashboard loaded."]),i=k([]),R=k(null),_=k(!1),C=k(!1),A=k(!1),O=k(!1),D=k(!1),l=k("unknown"),g=k(null),m=L(()=>R.value!==null||C.value||A.value||_.value),h=async e=>{const a=new Headers(e??{}),s=await b.ensureAccessToken();return s&&a.set("Authorization",`Bearer ${s}`),a},V=async(e,a={})=>{const s=await h(a.headers);return await $fetch(e,{baseURL:J(e),...a,headers:s})},ve=e=>!e||typeof e!="object"||Array.isArray(e)?null:e,z=e=>{if(!e)return"Unknown";const a=new Date(e);if(Number.isNaN(a.getTime()))return e;const s=a.toISOString();return`${s.slice(0,10)} ${s.slice(11,19)} UTC`},he=e=>{if(typeof e!="number"||Number.isNaN(e)||e<0)return"Unknown";if(e<1024)return`${e} B`;const a=["KB","MB","GB","TB"];let s=e/1024,d=0;for(;s>=1024&&d<a.length-1;)s/=1024,d+=1;return`${s>=10?s.toFixed(1):s.toFixed(2)} ${a[d]}`},ye=e=>e?.toLowerCase()==="ready"?"ready":"failed",we=e=>(Array.isArray(e)?e:e?.snapshots??e?.items??[]).map((s,d)=>{const w=s.filename??s.name,v=typeof w=="string"?w.trim():"";if(!v)return null;const U=typeof s.size_bytes=="number"?s.size_bytes:typeof s.size=="number"?s.size:null,j=typeof s.size=="string"?s.size:he(U),P=z(s.created_at??s.createdAt??s.timestamp);return{filename:v,createdAt:P,size:j,status:ye(s.status)}}).filter(s=>s!==null).sort((s,d)=>d.createdAt.localeCompare(s.createdAt)),_e=()=>new Date().toTimeString().slice(0,8),F=()=>new Date().toISOString(),S=e=>{x.value.push(`[${_e()}] ${e}`),x.value.length>300&&x.value.splice(0,x.value.length-300)},ke=e=>{const a=[],s=e?.data,d=ve(s);d&&["detail","error","message","traceback","stderr","stdout","shell_output"].forEach(j=>{const P=d[j];if(typeof P=="string"&&P.trim()){a.push(P.trim());return}if(P&&typeof P=="object")try{a.push(JSON.stringify(P,null,2))}catch{}});const w=e?.message;typeof w=="string"&&w.trim()&&a.push(w.trim());const v=Array.from(new Set(a.filter(Boolean)));return v.length?v.join(`

`):"Request failed"},K=(e,a)=>{const s=`[${F()}] ${e}
${ke(a)}`;i.value.unshift(s),i.value.length>60&&(i.value=i.value.slice(0,60))},ae=e=>e?typeof e=="string"?e.split(`
`).map(a=>a.trim()).filter(Boolean):Array.isArray(e)?e.map(a=>String(a).trim()).filter(Boolean):[]:[],De=e=>(Array.isArray(e)?e:e?.logs??e?.items??[]).map((s,d)=>{if(typeof s=="string")return{id:`log-${d}-${s}`,timestamp:z(F()),message:s,level:"info"};const w=z(s.timestamp??s.created_at??F()),v=s.message||s.detail||"";if(!v)return null;const U=String(s.level??"info").toLowerCase(),j=U==="error"?"error":U==="warning"||U==="warn"?"warning":"info";return{id:`log-${d}-${w}-${v}`,timestamp:w,message:v,level:j}}).filter(s=>s!==null),Se=(e,a,s)=>{if(!e)return a;const d=e.match(/filename\*\s*=\s*UTF-8''([^;]+)/i);if(d?.[1]){const v=decodeURIComponent(d[1].trim());return v.toLowerCase().endsWith(s)?v:`${v}${s}`}const w=e.match(/filename\s*=\s*\"?([^\";]+)\"?/i);if(w?.[1]){const v=w[1].trim();return v.toLowerCase().endsWith(s)?v:`${v}${s}`}return a},Re=(e,a)=>{const s=URL.createObjectURL(e),d=document.createElement("a");d.href=s,d.download=a,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(s)},{data:$e,pending:Ce,error:oe,execute:Ae,refresh:Le}=re(ge,{server:!1,immediate:!1,baseURL:J(ge),onRequest:async({options:e})=>{e.headers=await h(e.headers)}},"$wBfKAiYlGD"),{data:Be,pending:Te,error:ne,execute:Oe,refresh:Pe}=re(be,{server:!1,immediate:!1,baseURL:J(be),onRequest:async({options:e})=>{e.headers=await h(e.headers)}},"$DahtjvqONk"),{data:Ue,pending:Ie,error:le,execute:Ne,refresh:ze}=re(xe,{server:!1,immediate:!1,baseURL:J(xe),onRequest:async({options:e})=>{e.headers=await h(e.headers)}},"$rcXaNtjSx5"),Fe=L(()=>we($e.value)),ie=L(()=>De(Ue.value)),He=L(()=>i.value.length?i.value:["[--] Waiting for failures..."]);fe(Be,e=>{const a=e?.current_revision??e?.revision;a&&(l.value=a)},{immediate:!0});const de=async()=>{if(!O.value){O.value=!0;try{await Le()}finally{O.value=!1}}},H=async()=>{if(!D.value){D.value=!0;try{await ze(),g.value=z(F())}finally{D.value=!1}}},Ee=async()=>{await Pe()},je=async e=>{if(!m.value){R.value=e,S(`Snapshot restore started: ${e}`);try{const a=`/api/v1/admin/database/snapshots/${encodeURIComponent(e)}/restore`,s=await V(a,{method:"POST"}),d=typeof s?.message=="string"?s.message:`Snapshot restored: ${e}`;S(d),await Promise.allSettled([de(),H()])}catch(a){S(`Snapshot restore failed: ${e}`),K("Snapshot restore failed",a)}finally{R.value=null}}},Me=async()=>{if(!_.value){_.value=!0,S("Dump download requested.");try{const e=await h(),a=await fetch(Xe(zt),{method:"GET",headers:e});if(!a.ok){const v=await a.text();throw new Error(v||`Download failed (${a.status})`)}const s=await a.blob(),d=`database-dump-${new Date().toISOString().slice(0,19).replace(/[:]/g,"-")}.sql`,w=Se(a.headers.get("content-disposition"),d,".sql");Re(s,w),S(`Dump downloaded: ${w}`)}catch(e){S("Dump download failed."),K("Dump download failed",e)}finally{_.value=!1}}},qe=async e=>{if(!m.value){C.value=!0,S(`SQL upload started: ${e.name}`);try{const a=new FormData;a.append("file",e);const s=await V(Ft,{method:"POST",body:a}),d=typeof s?.message=="string"?s.message:`SQL restore uploaded: ${e.name}`;S(d),await H()}catch(a){S(`SQL restore failed: ${e.name}`),K("SQL restore upload failed",a)}finally{C.value=!1}}},We=async()=>{if(!m.value){A.value=!0,S("Alembic upgrade head started.");try{const e=await V(Nt,{method:"POST"}),a=[...ae(e.log),...ae(e.logs),...ae(e.output)];a.length===0?S("Alembic upgrade completed."):a.forEach(d=>S(d));const s=e.current_revision??e.revision;s&&(l.value=s,S(`Current revision: ${s}`)),await Promise.allSettled([Ee(),H()])}catch(e){S("Alembic upgrade failed."),K("Alembic upgrade failed",e)}finally{A.value=!1}}};let E=null;const ue=()=>{E&&(clearInterval(E),E=null)},Ge=()=>{E||(E=xt(()=>{$.value&&H().catch(()=>{})},1e4))},Qe=async()=>{await Promise.allSettled([Ae(),Oe(),Ne()]),g.value=z(F())};return fe(()=>b.user?.role,async e=>{if(e!=="admin"){ue();return}await Qe(),Ge()},{immediate:!0}),Je(()=>{ue()}),(e,a)=>t(u)?t($)?(c(),p("div",yt,[a[3]||(a[3]=r("section",{class:"rounded-2xl border border-slate-800 bg-slate-950 p-5 shadow-xl shadow-slate-950/50"},[r("p",{class:"text-xs uppercase tracking-[0.3em] text-slate-500"},"Database Operations"),r("h2",{class:"mt-2 text-xl font-semibold text-slate-100"},"DB Management"),r("p",{class:"mt-2 text-sm text-slate-400"}," Create snapshots, restore database dumps, run Alembic migrations, and track operation logs. ")],-1)),r("div",wt,[n(bt,{snapshots:t(Fe),loading:t(Ce),refreshing:t(O),"restoring-snapshot-id":t(R),"destructive-disabled":t(m),onRefreshSnapshots:de,onRestoreSnapshot:je},null,8,["snapshots","loading","refreshing","restoring-snapshot-id","destructive-disabled"]),n(ot,{"downloading-dump":t(_),"uploading-dump":t(C),"destructive-disabled":t(m),onDownloadDb:Me,onRestoreFile:qe},null,8,["downloading-dump","uploading-dump","destructive-disabled"])]),n(dt,{"current-revision":t(l),"upgrading-head":t(A),"loading-revision":t(Te),"destructive-disabled":t(m),onUpgradeHead:We},null,8,["current-revision","upgrading-head","loading-revision","destructive-disabled"]),n(me,{title:"Console",caption:"Execution Feed",logs:t(x),pending:!1,"empty-message":"Waiting for database commands..."},null,8,["logs"]),r("section",_t,[r("div",kt,[r("div",null,[a[0]||(a[0]=r("p",{class:"text-xs uppercase tracking-[0.2em] text-slate-500"},"Audit",-1)),a[1]||(a[1]=r("h3",{class:"text-sm font-semibold text-slate-100"},"Operation Logs",-1)),r("p",Dt," Last update: "+f(t(g)||"not loaded"),1)]),r("button",{type:"button",class:"inline-flex items-center rounded-md border border-slate-700 px-3 py-1.5 text-xs font-medium text-slate-200 transition hover:border-slate-600 hover:bg-slate-800 disabled:cursor-not-allowed disabled:opacity-50",disabled:t(D),onClick:H},f(t(D)?"Refreshing...":"Refresh Logs"),9,St)]),r("div",Rt,[t(Ie)?(c(),p("div",$t,[(c(),p(N,null,G(4,s=>r("div",{key:`op-log-skeleton-${s}`,class:"h-4 animate-pulse rounded bg-slate-800"})),64))])):t(ie).length?(c(),p("ul",Ct,[(c(!0),p(N,null,G(t(ie),s=>(c(),p("li",{key:s.id,class:"rounded-lg border border-slate-800 bg-slate-950/70 px-3 py-2 text-xs text-slate-300"},[r("span",At,f(s.timestamp),1),r("span",{class:W(["ml-2",s.level==="error"?"text-red-300":s.level==="warning"?"text-amber-300":"text-slate-200"])},f(s.message),3)]))),128))])):(c(),p("p",Lt," No operation logs yet. "))])]),n(me,{title:"Error Console",caption:"Stack Traces / Shell Output",logs:t(He),pending:!1,"empty-message":"[--] Waiting for failures...",variant:"error"},null,8,["logs"]),t(oe)?(c(),p("div",Bt," Failed to load snapshots: "+f(t(oe).message),1)):M("",!0),t(ne)?(c(),p("div",Tt," Failed to load migration status: "+f(t(ne).message),1)):M("",!0),t(le)?(c(),p("div",Ot," Failed to load operation logs: "+f(t(le).message),1)):M("",!0),t(R)?(c(),p("div",Pt,[r("div",Ut,[a[2]||(a[2]=r("p",{class:"text-xs uppercase tracking-[0.2em] text-orange-300"},"Database Restore",-1)),r("p",It," Restoring... "+f(t(R)),1)])])):M("",!0)])):(c(),p("div",ht," Access denied. This page is available for super admin only. ")):(c(),p("div",vt," Checking access... "))}});export{ds as default};
