import{f as Te,N as ue,k as Ke,G as p,H as l,K as f,L as k,O as n,W as K,J as g,P as ie,Q as oe,S as A,v,F as r,M as h,U as xe,V as _e,Y as G,y as O,R as Ce,T as z,c as We,X as J,$ as Ge}from"./Cu9pBwV9.js";import T from"./19XThGzF.js";import Y from"./qtYjwcMh.js";import Se from"./FpDCiqsp.js";import re from"./DZFHlsC0.js";import"./CZ5eJ5C_.js";import"./BRYvvQpL.js";import"./CLBxTCuQ.js";import"./Dxox8W-8.js";import"./VECgceg4.js";import"./BBGM9ROk.js";import"./CNyPXozD.js";import Je from"./BMPggNyw.js";import"./1MT8oc-r.js";import"./TWMK2zgj.js";import"./Byzpnqrt.js";import"./CFHGTpjn.js";import"./Btik6d0e.js";import"./31q3d9H4.js";import{c as de}from"./DcXT16v2.js";import{u as Ye}from"./C5I5sUlo.js";import"./CkYB-R1u.js";import"./c5FhCeC0.js";const He=de("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const Xe=de("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);const qe=de("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),Qe={class:"space-y-6"},Ze={class:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm"},et={class:"flex flex-wrap items-start justify-between gap-4"},tt={class:"flex flex-wrap items-center gap-2"},st={class:"mt-4 max-w-lg"},nt={key:0,class:"mt-4 rounded-xl border border-slate-200 bg-slate-50 px-4 py-3"},at={class:"text-sm font-medium text-slate-700"},lt={key:0,class:"mt-2 space-y-1 text-xs text-red-600"},it={key:0,class:"rounded-2xl border border-amber-200/70 bg-amber-50/80 p-5 shadow-sm"},ot={class:"flex flex-wrap items-center justify-between gap-4"},rt={class:"rounded-2xl border border-slate-200 bg-white p-4 shadow-sm"},ut={class:"flex flex-wrap gap-2"},dt=["onClick"],ct={class:"mt-4 rounded-xl border border-slate-200 bg-slate-50/50 p-4"},pt={class:"flex flex-wrap items-start justify-between gap-3"},mt={class:"text-lg font-semibold text-slate-900"},yt={class:"text-xs text-slate-500"},ft={class:"text-xs text-slate-500"},gt={key:0,class:"py-10 text-center text-sm text-slate-500"},vt={key:1,class:"mt-4 rounded-xl border border-dashed border-slate-200 bg-white px-4 py-8 text-center text-sm text-slate-500"},kt={key:0},bt={key:1},ht={key:2,class:"mt-4 grid gap-4 lg:grid-cols-2"},xt={class:"flex flex-wrap items-start justify-between gap-3"},_t={class:"min-w-0"},Ct={class:"truncate text-sm font-semibold text-slate-900"},St={class:"mt-1 text-xs text-slate-500"},Tt={class:"flex flex-wrap items-center gap-1"},Et={class:"mt-3"},Dt=["onUpdate:modelValue","onChange"],Vt={key:0,class:"mt-2 text-xs text-slate-500"},Ut={class:"mt-4 flex flex-wrap items-center justify-between gap-2"},At={class:"flex flex-wrap items-center gap-2"},Ot={key:2,class:"text-xs text-slate-400"},Rt={class:"space-y-4"},Ft={class:"flex items-start justify-between gap-4"},It={class:"grid gap-3"},Lt={class:"flex items-center justify-end gap-2"},Mt={key:1,class:"fixed bottom-6 right-6 z-50 rounded-xl bg-slate-900 px-4 py-3 text-sm text-white shadow-2xl"},Nt={key:2,class:"rounded-2xl border border-red-200 bg-red-50 p-4 text-sm text-red-700"},Pt=Te({__name:"SettingsManagerBlock",props:{settings:{},pending:{type:Boolean},hasError:{type:Boolean},isAdmin:{type:Boolean},seeding:{type:Boolean},onRefresh:{type:Function},onSaveSetting:{type:Function},onDeleteSetting:{type:Function},onCreateSetting:{type:Function},onUpsertSetting:{type:Function},onSeedDatabase:{type:Function}},setup(ce){const u=ce,R=[{id:"payments",label:"Payments",hint:"PAYMENT_, CRYPTOBOT, MOCK_TOPUP",tokens:["PAYMENT_","CRYPTOBOT","MOCK_TOPUP"]},{id:"security",label:"Security",hint:"JWT_, SECRET, TOKEN, ADMIN_",tokens:["JWT_","SECRET","TOKEN","ADMIN_"]},{id:"storage",label:"Storage",hint:"S3_, GCP_, LOCAL_STORAGE",tokens:["S3_","GCP_","LOCAL_STORAGE"]},{id:"game",label:"Game",hint:"XP_, LEVEL_, TICKET",tokens:["XP_","LEVEL_","TICKET"]},{id:"general",label:"General",hint:"DOMAIN, MAINTENANCE, APP_MODE and all unmatched keys",tokens:[]}],d=v([]),c=G({}),x=G({}),y=G({}),V=G({}),B=v("");let U=null;const L=v(""),E=v("payments"),F=v(!1),M=v(!1),N=v(!1),I=v(""),P=v(""),j=v("string"),D=v(""),$=v(!1),S=v(""),i=v([]),o=v(null),C=t=>{if(!t)return t;let e=t;const s=t.trim();if(s.startsWith('"')&&s.endsWith('"'))try{const a=JSON.parse(s);typeof a=="string"&&(e=a)}catch{}return e.includes("\\u")&&(e=e.replace(/\\u([0-9a-fA-F]{4})/g,(a,m)=>String.fromCharCode(parseInt(m,16)))),e},_=t=>({...t,value:C(String(t.value??"")),description:t.description==null?null:C(t.description)}),H=()=>{const t=new Set(d.value.map(e=>e.key));Object.keys(c).forEach(e=>{t.has(e)||(delete c[e],delete x[e],delete y[e],delete V[e])}),d.value.forEach(e=>{c[e.key]=e.value??"",x[e.key]=!1})};ue(()=>u.settings,t=>{d.value=t?t.map(e=>_(e)).sort((e,s)=>e.key.localeCompare(s.key)):[],H()},{immediate:!0,deep:!0});const b=t=>{B.value=t,U&&clearTimeout(U),U=setTimeout(()=>{B.value="",U=null},2500)};Ke(()=>{U&&clearTimeout(U)});const Ee=t=>{const e=t.toUpperCase();return R[0].tokens.some(s=>e.includes(s))?"payments":R[1].tokens.some(s=>e.includes(s))?"security":R[2].tokens.some(s=>e.includes(s))?"storage":R[3].tokens.some(s=>e.includes(s))?"game":"general"},X=O(()=>L.value.trim().toLowerCase()),De=O(()=>X.value?d.value.filter(t=>{const e=t.key.toLowerCase(),s=String(c[t.key]??t.value??"").toLowerCase();return e.includes(X.value)||s.includes(X.value)}):d.value),q=O(()=>{const t={payments:[],security:[],storage:[],game:[],general:[]};return De.value.forEach(e=>{const s=Ee(e.key);t[s].push(e)}),Object.keys(t).forEach(e=>{t[e].sort((s,a)=>s.key.localeCompare(a.key))}),t}),Q=O(()=>R.map(t=>({...t,count:q.value[t.id].length}))),pe=O(()=>Q.value.find(t=>t.id===E.value)??Q.value[0]),Z=O(()=>q.value[E.value]??[]);ue(q,t=>{if(t[E.value]?.length)return;const e=R.find(s=>t[s.id].length>0);e&&(E.value=e.id)},{deep:!0});const Ve=t=>{if(t==null)return null;const e=C(t).trim();if(!e)return null;const s=e.replace(/\s+/g,"");if(/^[?\uFFFD]+$/.test(s))return null;const a=/[A-Za-z0-9\u0400-\u04FF]/.test(e),m=(s.match(/[?\uFFFD]/g)??[]).length;return!a&&m>0?null:e},me=O(()=>{const t={};return d.value.forEach(e=>{t[e.key]=Ve(e.description)}),t}),ee=t=>{const e=d.value.find(s=>s.key===t)?.value??"";x[t]=(c[t]??"")!==e},Ue=t=>{const e=d.value.find(s=>s.key===t)?.value??"";c[t]=e,x[t]=!1},te=t=>{const e=d.value.findIndex(a=>a.key===t.key);if(e===-1){d.value=[t,...d.value].sort((a,m)=>a.key.localeCompare(m.key));return}const s=[...d.value];s[e]=t,d.value=s.sort((a,m)=>a.key.localeCompare(m.key))},Ae=t=>{d.value=d.value.filter(e=>e.key!==t),delete c[t],delete x[t],delete y[t],delete V[t]},Oe=async()=>{if(!F.value){F.value=!0;try{await u.onRefresh(),b("Settings refreshed")}catch{b("Failed to refresh settings")}finally{F.value=!1}}},Re=async t=>{if(!(!x[t.key]||y[t.key])){y[t.key]=!0;try{const e=await u.onSaveSetting({key:t.key,value:c[t.key]??"",description:t.description??null,is_public:t.is_public??!1}),s=_(e);te(s),c[t.key]=s.value??"",x[t.key]=!1,b(`Saved ${t.key}`)}catch{b(`Failed to save ${t.key}`)}finally{y[t.key]=!1}}},Fe=async t=>{if(!V[t.key]&&window.confirm(`Delete setting ${t.key}?`)){V[t.key]=!0;try{await u.onDeleteSetting(t.key),Ae(t.key),b(`Deleted ${t.key}`)}catch{b(`Failed to delete ${t.key}`)}finally{V[t.key]=!1}}},Ie=()=>{M.value=!0},se=()=>{M.value=!1,I.value="",P.value="",j.value="string",D.value=""},Le=async()=>{const t=I.value.trim().toUpperCase();if(t){N.value=!0;try{const e=await u.onCreateSetting({key:t,value:P.value,value_type:j.value,description:D.value.trim()||null,is_public:!1}),s=_(e);te(s),c[s.key]=s.value??"",x[s.key]=!1,b(`Created ${s.key}`),se()}catch{b("Failed to create setting")}finally{N.value=!1}}},Me=()=>{const t={exported_at:new Date().toISOString(),total:d.value.length,settings:d.value.map(m=>({key:m.key,value:c[m.key]??m.value??"",value_type:m.value_type,description:m.description??null,is_public:m.is_public??!1,is_encrypted:m.is_encrypted??!1}))},e=new Blob([JSON.stringify(t,null,2)],{type:"application/json;charset=utf-8"}),s=URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download="settings_backup.json",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s),b("settings_backup.json downloaded")},Ne=()=>{o.value?.click()},ne=t=>!t||typeof t!="object"||Array.isArray(t)?null:t,ye=t=>t.trim().toUpperCase(),Pe=t=>{const e=ne(t);if(!e)return null;const s=e.key??e.name;if(typeof s!="string")return null;const a=ye(s);return a?{key:a,value:e.value??"",description:typeof e.description=="string"?e.description:null,value_type:typeof e.value_type=="string"?e.value_type:null,is_public:typeof e.is_public=="boolean"?e.is_public:null}:null},je=(t,e)=>{const s=ye(t);if(!s)return null;const a=ne(e);return a&&("value"in a||"description"in a||"value_type"in a||"is_public"in a)?{key:s,value:a.value??"",description:typeof a.description=="string"?a.description:null,value_type:typeof a.value_type=="string"?a.value_type:null,is_public:typeof a.is_public=="boolean"?a.is_public:null}:{key:s,value:e,description:null,value_type:null,is_public:null}},fe=t=>{if(Array.isArray(t))return t.map(a=>Pe(a)).filter(a=>a!==null);const e=ne(t);if(!e)return[];const s=e.settings??e.items;return Array.isArray(s)?fe(s):Object.entries(e).map(([a,m])=>je(a,m)).filter(a=>a!==null)},ge=t=>{if(typeof t=="string")return t;if(t==null)return"";if(typeof t=="object")try{return JSON.stringify(t)}catch{return String(t)}return String(t)},ze=t=>{if(typeof t=="boolean")return"boolean";if(t&&typeof t=="object")return"json";const e=ge(t).trim().toLowerCase();return e==="true"||e==="false"?"boolean":e.startsWith("{")&&e.endsWith("}")||e.startsWith("[")&&e.endsWith("]")?"json":"string"},Be=t=>{const e=t?.data?.detail;if(typeof e=="string"&&e)return e;const s=t?.message;return typeof s=="string"&&s?s:"request failed"},$e=async t=>{const e=t.target,s=e.files?.[0];if(s){S.value="",i.value=[];try{const a=await s.text(),m=JSON.parse(a),ve=fe(m);if(!ve.length){S.value="No valid settings found in file.",b(S.value);return}$.value=!0;let ke=0,be=0;const he=[];for(const w of ve){const ae=w.key.trim().toUpperCase();if(ae)try{const le=await u.onUpsertSetting({key:ae,value:ge(w.value),description:w.description??void 0,value_type:w.value_type??ze(w.value),is_public:w.is_public??void 0}),W=_(le);te(W),c[W.key]=W.value??"",x[W.key]=!1,ke+=1}catch(le){be+=1,he.push(`${ae}: ${Be(le)}`)}}S.value=`Updated ${ke} settings, Errors: ${be}`,i.value=he.slice(0,8);try{await u.onRefresh()}catch{}b(S.value)}catch{S.value="Import failed: invalid JSON.",i.value=[],b(S.value)}finally{$.value=!1,e.value=""}}},we=async()=>{try{await u.onSeedDatabase(),b("Database seeded")}catch{b("Failed to seed database")}};return(t,e)=>(r(),p("div",Qe,[l("section",Ze,[l("div",et,[e[8]||(e[8]=l("div",null,[l("p",{class:"text-xs uppercase tracking-[0.3em] text-slate-500"},"System Config"),l("h2",{class:"text-lg font-semibold"},"System settings"),l("p",{class:"text-sm text-slate-500"},"Find, edit and backup key-value configuration safely.")],-1)),l("div",tt,[f(n(T),{variant:"outline",size:"sm",disabled:n(F),onClick:Oe},{default:k(()=>[h(g(n(F)?"Refreshing...":"Refresh"),1)]),_:1},8,["disabled"]),f(n(T),{variant:"outline",size:"sm",onClick:Me},{default:k(()=>[...e[6]||(e[6]=[h(" Export ",-1)])]),_:1}),f(n(T),{variant:"outline",size:"sm",disabled:n($),onClick:Ne},{default:k(()=>[h(g(n($)?"Importing...":"Import"),1)]),_:1},8,["disabled"]),l("input",{ref_key:"importInputRef",ref:o,type:"file",accept:"application/json,.json",class:"hidden",onChange:$e},null,544),f(n(T),{size:"sm",class:"gap-2",onClick:Ie},{default:k(()=>[f(n(He),{class:"h-4 w-4"}),e[7]||(e[7]=h(" Add Config ",-1))]),_:1})])]),l("div",st,[e[9]||(e[9]=l("label",{class:"text-xs uppercase tracking-[0.2em] text-slate-500"},"Search",-1)),f(n(Y),{modelValue:n(L),"onUpdate:modelValue":e[0]||(e[0]=s=>K(L)?L.value=s:null),type:"search",placeholder:"Search by key or value",class:"mt-2"},null,8,["modelValue"])]),n(S)?(r(),p("div",nt,[l("p",at,g(n(S)),1),n(i).length?(r(),p("ul",lt,[(r(!0),p(ie,null,oe(n(i),s=>(r(),p("li",{key:s},g(s),1))),128))])):A("",!0)])):A("",!0)]),u.isAdmin?(r(),p("section",it,[l("div",ot,[e[10]||(e[10]=l("div",null,[l("p",{class:"text-xs uppercase tracking-[0.3em] text-amber-700"},"Developer Tools"),l("h2",{class:"text-lg font-semibold text-amber-900"},"Developer Tools"),l("p",{class:"text-sm text-amber-800/80"},"Danger zone: fill the database with fake data.")],-1)),f(n(T),{variant:"destructive",size:"sm",disabled:u.seeding,onClick:we},{default:k(()=>[h(g(u.seeding?"Seeding...":"Fill Database with Fake Data"),1)]),_:1},8,["disabled"])])])):A("",!0),l("section",rt,[l("div",ut,[(r(!0),p(ie,null,oe(n(Q),s=>(r(),p("button",{key:s.id,type:"button",class:Ce(["inline-flex items-center gap-2 rounded-full border px-3 py-1.5 text-xs font-semibold uppercase tracking-[0.15em] transition",n(E)===s.id?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-600 hover:border-slate-300 hover:text-slate-900"]),onClick:a=>E.value=s.id},[l("span",null,g(s.label),1),l("span",{class:Ce(["inline-flex min-w-[22px] items-center justify-center rounded-full px-1.5 py-0.5 text-[10px]",n(E)===s.id?"bg-white/20 text-white":"bg-slate-100 text-slate-600"])},g(s.count),3)],10,dt))),128))]),l("div",ct,[l("div",pt,[l("div",null,[e[11]||(e[11]=l("p",{class:"text-xs uppercase tracking-[0.2em] text-slate-500"},"Category",-1)),l("h3",mt,g(n(pe).label),1),l("p",yt,"Match rules: "+g(n(pe).hint),1)]),l("p",ft,g(n(Z).length)+" settings",1)]),u.pending&&n(d).length===0?(r(),p("div",gt," Loading settings... ")):n(Z).length===0?(r(),p("div",vt,[n(L)?(r(),p("span",kt,"No settings found for the current search.")):(r(),p("span",bt,"No settings in this category."))])):(r(),p("div",ht,[(r(!0),p(ie,null,oe(n(Z),s=>(r(),p("article",{key:s.key,class:"rounded-xl border border-slate-200 bg-white p-4 shadow-sm"},[l("div",xt,[l("div",_t,[l("p",Ct,g(s.key),1),l("p",St,"Type: "+g(s.value_type),1)]),l("div",Tt,[f(n(re),{variant:"outline"},{default:k(()=>[h(g(s.value_type),1)]),_:2},1024),s.is_public?(r(),z(n(re),{key:0,variant:"success"},{default:k(()=>[...e[12]||(e[12]=[h("Public",-1)])]),_:1})):A("",!0),s.is_encrypted?(r(),z(n(re),{key:1,variant:"warning"},{default:k(()=>[...e[13]||(e[13]=[h("Encrypted",-1)])]),_:1})):A("",!0)])]),l("div",Et,[s.value_type==="json"?(r(),z(n(Se),{key:0,"model-value":n(c)[s.key],class:"min-h-[92px] text-xs font-mono","onUpdate:modelValue":a=>{n(c)[s.key]=a,ee(s.key)}},null,8,["model-value","onUpdate:modelValue"])):s.value_type==="boolean"?xe((r(),p("select",{key:1,"onUpdate:modelValue":a=>n(c)[s.key]=a,class:"h-10 w-full rounded-md border border-input bg-background px-3 text-sm",onChange:a=>ee(s.key)},[...e[14]||(e[14]=[l("option",{value:"true"},"true",-1),l("option",{value:"false"},"false",-1)])],40,Dt)),[[_e,n(c)[s.key]]]):(r(),z(n(Y),{key:2,"model-value":n(c)[s.key],class:"h-10 text-sm","onUpdate:modelValue":a=>{n(c)[s.key]=a,ee(s.key)}},null,8,["model-value","onUpdate:modelValue"]))]),n(me)[s.key]?(r(),p("p",Vt,g(n(me)[s.key]),1)):A("",!0),l("div",Ut,[l("div",At,[n(x)[s.key]?(r(),z(n(T),{key:0,variant:"outline",size:"sm",class:"gap-2",disabled:n(y)[s.key],onClick:a=>Re(s)},{default:k(()=>[f(n(Xe),{class:"h-4 w-4"}),h(" "+g(n(y)[s.key]?"Saving...":"Save"),1)]),_:2},1032,["disabled","onClick"])):A("",!0),n(x)[s.key]?(r(),z(n(T),{key:1,variant:"ghost",size:"sm",onClick:a=>Ue(s.key)},{default:k(()=>[...e[15]||(e[15]=[h(" Reset ",-1)])]),_:1},8,["onClick"])):(r(),p("span",Ot,"No changes"))]),f(n(T),{variant:"outline",size:"sm",class:"gap-2 text-red-600",disabled:n(V)[s.key],onClick:a=>Fe(s)},{default:k(()=>[f(n(qe),{class:"h-4 w-4"}),h(" "+g(n(V)[s.key]?"Deleting...":"Delete"),1)]),_:2},1032,["disabled","onClick"])])]))),128))]))])]),f(n(Je),{modelValue:n(M),"onUpdate:modelValue":e[5]||(e[5]=s=>K(M)?M.value=s:null)},{default:k(()=>[l("div",Rt,[l("div",Ft,[e[17]||(e[17]=l("div",null,[l("h3",{class:"text-lg font-semibold text-foreground"},"Add Config"),l("p",{class:"text-sm text-muted-foreground"},"Create a new system setting.")],-1)),f(n(T),{variant:"ghost",size:"sm",onClick:se},{default:k(()=>[...e[16]||(e[16]=[h("Close",-1)])]),_:1})]),l("div",It,[l("div",null,[e[18]||(e[18]=l("label",{class:"text-xs uppercase tracking-[0.2em] text-muted-foreground"},"Key",-1)),f(n(Y),{modelValue:n(I),"onUpdate:modelValue":e[1]||(e[1]=s=>K(I)?I.value=s:null),placeholder:"AI_GENERATION_ENABLED"},null,8,["modelValue"])]),l("div",null,[e[19]||(e[19]=l("label",{class:"text-xs uppercase tracking-[0.2em] text-muted-foreground"},"Value",-1)),f(n(Y),{modelValue:n(P),"onUpdate:modelValue":e[2]||(e[2]=s=>K(P)?P.value=s:null),placeholder:"true"},null,8,["modelValue"])]),l("div",null,[e[21]||(e[21]=l("label",{class:"text-xs uppercase tracking-[0.2em] text-muted-foreground"},"Type",-1)),xe(l("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>K(j)?j.value=s:null),class:"h-10 w-full rounded-md border border-input bg-background px-3 text-sm"},[...e[20]||(e[20]=[l("option",{value:"string"},"String",-1),l("option",{value:"json"},"JSON",-1),l("option",{value:"boolean"},"Boolean",-1)])],512),[[_e,n(j)]])]),l("div",null,[e[22]||(e[22]=l("label",{class:"text-xs uppercase tracking-[0.2em] text-muted-foreground"},"Description",-1)),f(n(Se),{modelValue:n(D),"onUpdate:modelValue":e[4]||(e[4]=s=>K(D)?D.value=s:null),placeholder:"Short description"},null,8,["modelValue"])])]),l("div",Lt,[f(n(T),{variant:"outline",onClick:se},{default:k(()=>[...e[23]||(e[23]=[h("Cancel",-1)])]),_:1}),f(n(T),{disabled:n(N),onClick:Le},{default:k(()=>[h(g(n(N)?"Creating...":"Create"),1)]),_:1},8,["disabled"])])])]),_:1},8,["modelValue"]),n(B)?(r(),p("div",Mt,g(n(B)),1)):A("",!0),u.hasError?(r(),p("div",Nt," Failed to load settings. ")):A("",!0)]))}}),rs=Te({__name:"index",setup(ce){const u=We(),{data:R,pending:d,error:c,refresh:x}=Ye("admin-settings",()=>u.apiFetch("/api/v1/admin/settings",{baseURL:J("/api/v1/admin/settings")})),y=v([]);ue(R,i=>{y.value=i?[...i]:[]},{immediate:!0});const V=O(()=>u.user?.role==="admin"),B=async()=>{await x()},U=i=>{const o=y.value.findIndex(_=>_.key===i.key);if(o===-1){y.value=[i,...y.value];return}const C=[...y.value];C[o]=i,y.value=C},L=i=>{y.value=y.value.filter(o=>o.key!==i)},E=i=>`/api/v1/admin/settings/${encodeURIComponent(i)}`,F=async i=>{const o=E(i.key),C={value:String(i.value??""),description:i.description??null,is_public:i.is_public??!1},_=await u.apiFetch(o,{method:"PUT",baseURL:J(o),body:C});return U(_),_},M=async i=>{const o=E(i);await u.apiFetch(o,{method:"DELETE",baseURL:J(o)}),L(i)},N=async i=>{const o=await u.apiFetch("/api/v1/admin/settings",{method:"POST",baseURL:J("/api/v1/admin/settings"),body:i});return U(o),o},I=(i,o)=>typeof i=="boolean"?i:o,P=i=>{const o=i.trim().toLowerCase();return o==="true"||o==="false"?"boolean":o.startsWith("{")&&o.endsWith("}")||o.startsWith("[")&&o.endsWith("]")?"json":"string"},j=async i=>{const o=i.key.trim().toUpperCase(),C=String(i.value??""),_=y.value.find(H=>H.key===o);return _?await F({key:o,value:C,description:i.description!==void 0?i.description:_.description??null,is_public:I(i.is_public,_.is_public??!1)}):await N({key:o,value:C,value_type:i.value_type?.trim()||P(C),description:i.description??null,is_public:I(i.is_public,!1)})},D=v(!1),$=O(()=>Ge("/api/v1/debug/seed")),S=async()=>{if(!D.value){D.value=!0;try{await u.apiFetch($.value,{method:"POST"})}finally{D.value=!1}}};return(i,o)=>(r(),z(Pt,{settings:n(y),pending:n(d),"has-error":!!n(c),"is-admin":n(V),seeding:n(D),"on-refresh":B,"on-save-setting":F,"on-delete-setting":M,"on-create-setting":N,"on-upsert-setting":j,"on-seed-database":S},null,8,["settings","pending","has-error","is-admin","seeding"]))}});export{rs as default};
