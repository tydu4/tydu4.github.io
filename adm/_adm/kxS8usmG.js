import{f as ne,c as ie,N as de,G as v,H as l,K as o,L as n,O as t,S as _,W as T,J as A,v as m,X as M,F as u,M as i,T as F,P as re,Q as ue,U as $,V as H,Y as P,y as I,ac as pe}from"./CJct0Du1.js";import f from"./CrKAO1Du.js";import j from"./BCmSOTEA.js";import K from"./B5uDJmdT.js";import"./D96hOBhx.js";import"./CTF75BhX.js";import me from"./-ph6IaWM.js";import ce from"./B9WBDtYp.js";import fe from"./DwUrod7N.js";import z from"./nvNydXzv.js";import N from"./5Tvz58Fd.js";import x from"./3luMke7s.js";import ve from"./DBN8MR29.js";import"./otl20aZW.js";import"./DZdvKC0b.js";import"./VXFjAwDO.js";import"./DVEWYwXv.js";import"./Cv6uNvyJ.js";import"./Xz7cpnIQ.js";import{u as ge}from"./DBhd_BX4.js";import{c as B}from"./C1FMIx73.js";import"./CkYB-R1u.js";import"./c5FhCeC0.js";const ye=B("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const xe=B("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);const ke=B("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),be={class:"space-y-6"},he={class:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm"},Ve={class:"flex flex-wrap items-center justify-between gap-4"},Ce={class:"flex items-center gap-2"},Se={key:0,class:"rounded-2xl border border-amber-200/70 bg-amber-50/80 p-5 shadow-sm"},Te={class:"flex flex-wrap items-center justify-between gap-4"},Ue={class:"rounded-2xl border border-slate-200 bg-white shadow-sm"},De={key:0,class:"min-w-[260px]"},_e=["onUpdate:modelValue","onChange"],Ae={class:"flex items-center justify-end gap-2"},Me={class:"space-y-4"},Fe={class:"flex items-start justify-between gap-4"},ze={class:"grid gap-3"},Ne={class:"flex items-center justify-end gap-2"},Ee={key:1,class:"fixed bottom-6 right-6 z-50 rounded-xl bg-slate-900 px-4 py-3 text-sm text-white shadow-2xl"},Le={key:2,class:"rounded-2xl border border-red-200 bg-red-50 p-4 text-sm text-red-700"},nt=ne({__name:"index",setup(je){const g=ie(),{data:J,pending:W,error:G,refresh:Q}=ge("admin-settings",()=>g.apiFetch("/api/v1/admin/settings",{baseURL:M("/api/v1/admin/settings")})),p=m([]),r=P({}),k=P({}),U=m(""),R=s=>{if(!s)return s;let e=s.trim();if(e.startsWith('"')&&e.endsWith('"'))try{const a=JSON.parse(e);typeof a=="string"&&(e=a)}catch{}if(e.includes("\\u")&&(e=e.replace(/\\u([0-9a-fA-F]{4})/g,(a,d)=>String.fromCharCode(parseInt(d,16)))),/[ÃÃ‘]/.test(e))try{const a=new Uint8Array(Array.from(e).map(oe=>oe.charCodeAt(0))),d=new TextDecoder("utf-8").decode(a);d.includes("")||(e=d)}catch{}return e},X=s=>R(String(s??"")),Y=s=>s==null?null:R(s),w=s=>({...s,value:X(s.value),description:Y(s.description)});de(J,s=>{p.value=s?s.map(e=>w(e)):[],p.value.forEach(e=>{r[e.key]=e.value??"",k[e.key]=!1})},{immediate:!0});const c=s=>{U.value=s,setTimeout(()=>{U.value=""},2500)},O={success:s=>c(s),error:s=>c(s)},q=I(()=>g.user?.role==="admin"),b=m(!1),Z=I(()=>pe("/api/v1/debug/seed")),ee=async()=>{if(!b.value){b.value=!0;try{await g.apiFetch(Z.value,{method:"POST"}),O.success("Ð”Ð°Ð½Ð½Ñ‹Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹")}catch{O.error("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ Ð´Ð°Ð½Ð½Ñ‹Ðµ")}finally{b.value=!1}}},E=s=>{const e=p.value.find(a=>a.key===s)?.value??"";k[s]=r[s]!==e},te=async s=>{const e={value:r[s.key]??"",description:s.description??null,is_public:s.is_public??!1};try{await g.apiFetch(`/api/v1/admin/settings/${s.key}`,{method:"PUT",baseURL:M(`/api/v1/admin/settings/${s.key}`),body:e}),s.value=r[s.key]??"",k[s.key]=!1,c("Setting saved")}catch{c("Failed to save setting")}},se=async s=>{try{await g.apiFetch(`/api/v1/admin/settings/${s.key}`,{method:"DELETE",baseURL:M(`/api/v1/admin/settings/${s.key}`)}),p.value=p.value.filter(e=>e.key!==s.key),c("Setting deleted")}catch{c("Failed to delete setting")}},h=m(!1),y=m(""),V=m(""),C=m("string"),S=m(""),D=m(!1),ae=()=>{h.value=!0},L=()=>{h.value=!1,y.value="",V.value="",C.value="string",S.value=""},le=async()=>{if(!y.value.trim())return;D.value=!0;const s={key:y.value.trim().toUpperCase(),value:V.value,value_type:C.value,description:S.value||null,is_public:!1};try{const e=await g.apiFetch("/api/v1/admin/settings",{method:"POST",baseURL:M("/api/v1/admin/settings"),body:s}),a=w(e);p.value=[a,...p.value],r[a.key]=a.value??"",k[a.key]=!1,c("Setting added"),L()}catch{c("Failed to create setting")}finally{D.value=!1}};return(s,e)=>(u(),v("div",be,[l("section",he,[l("div",Ve,[e[7]||(e[7]=l("div",null,[l("p",{class:"text-xs uppercase tracking-[0.3em] text-slate-500"},"System Config"),l("h2",{class:"text-lg font-semibold"},"System settings"),l("p",{class:"text-sm text-slate-500"},"Manage flags and parameters without redeploy.")],-1)),l("div",Ce,[o(t(f),{variant:"outline",size:"sm",onClick:t(Q)},{default:n(()=>[...e[5]||(e[5]=[i("Refresh",-1)])]),_:1},8,["onClick"]),o(t(f),{size:"sm",class:"gap-2",onClick:ae},{default:n(()=>[o(t(ye),{class:"h-4 w-4"}),e[6]||(e[6]=i(" Add Config ",-1))]),_:1})])])]),t(q)?(u(),v("section",Se,[l("div",Te,[e[9]||(e[9]=l("div",null,[l("p",{class:"text-xs uppercase tracking-[0.3em] text-amber-700"},"Developer Tools"),l("h2",{class:"text-lg font-semibold text-amber-900"},"Developer Tools"),l("p",{class:"text-sm text-amber-800/80"},"Danger zone: fill the database with fake data.")],-1)),o(t(f),{variant:"destructive",size:"sm",class:"gap-2",loading:t(b),disabled:t(b),onClick:ee},{default:n(()=>[...e[8]||(e[8]=[i(" ðŸ§¨ Fill Database with Fake Data ",-1)])]),_:1},8,["loading","disabled"])])])):_("",!0),l("section",Ue,[o(t(me),null,{default:n(()=>[o(t(ce),null,{default:n(()=>[o(t(z),null,{default:n(()=>[o(t(N),null,{default:n(()=>[...e[10]||(e[10]=[i("Key",-1)])]),_:1}),o(t(N),null,{default:n(()=>[...e[11]||(e[11]=[i("Value",-1)])]),_:1}),o(t(N),null,{default:n(()=>[...e[12]||(e[12]=[i("Description",-1)])]),_:1}),o(t(N),{class:"text-right"},{default:n(()=>[...e[13]||(e[13]=[i("Actions",-1)])]),_:1})]),_:1})]),_:1}),o(t(fe),null,{default:n(()=>[t(W)?(u(),F(t(z),{key:0},{default:n(()=>[o(t(x),{colspan:"4",class:"py-10 text-center text-sm text-slate-500"},{default:n(()=>[...e[14]||(e[14]=[i(" Loading settings... ",-1)])]),_:1})]),_:1})):t(p).length===0?(u(),F(t(z),{key:1},{default:n(()=>[o(t(x),{colspan:"4",class:"py-10 text-center text-sm text-slate-500"},{default:n(()=>[...e[15]||(e[15]=[i(" No settings yet ",-1)])]),_:1})]),_:1})):_("",!0),(u(!0),v(re,null,ue(t(p),a=>(u(),F(t(z),{key:a.key},{default:n(()=>[o(t(x),{class:"text-xs font-semibold text-slate-700"},{default:n(()=>[i(A(a.key),1)]),_:2},1024),o(t(x),{class:"min-w-[260px]"},{default:n(()=>[a.value_type==="json"?(u(),v("div",De,[o(t(K),{"model-value":t(r)[a.key],class:"min-h-[64px] text-xs","onUpdate:modelValue":d=>{t(r)[a.key]=d,E(a.key)}},null,8,["model-value","onUpdate:modelValue"])])):a.value_type==="boolean"?$((u(),v("select",{key:1,"onUpdate:modelValue":d=>t(r)[a.key]=d,class:"h-9 w-full rounded-md border border-input bg-background px-2 text-sm",onChange:d=>E(a.key)},[...e[16]||(e[16]=[l("option",{value:"true"},"true",-1),l("option",{value:"false"},"false",-1)])],40,_e)),[[H,t(r)[a.key]]]):(u(),F(t(j),{key:2,"model-value":t(r)[a.key]??"",class:"h-9 text-sm","onUpdate:modelValue":d=>{t(r)[a.key]=d,E(a.key)}},null,8,["model-value","onUpdate:modelValue"]))]),_:2},1024),o(t(x),{class:"text-sm text-slate-600"},{default:n(()=>[i(A(a.description||"?"),1)]),_:2},1024),o(t(x),{class:"text-right"},{default:n(()=>[l("div",Ae,[o(t(f),{variant:"outline",size:"sm",class:"gap-2",disabled:!t(k)[a.key],onClick:d=>te(a)},{default:n(()=>[o(t(xe),{class:"h-4 w-4"}),e[17]||(e[17]=i(" Save ",-1))]),_:1},8,["disabled","onClick"]),o(t(f),{variant:"outline",size:"sm",class:"gap-2 text-red-600",onClick:d=>se(a)},{default:n(()=>[o(t(ke),{class:"h-4 w-4"}),e[18]||(e[18]=i(" Delete ",-1))]),_:1},8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),o(t(ve),{modelValue:t(h),"onUpdate:modelValue":e[4]||(e[4]=a=>T(h)?h.value=a:null)},{default:n(()=>[l("div",Me,[l("div",Fe,[e[20]||(e[20]=l("div",null,[l("h3",{class:"text-lg font-semibold text-foreground"},"Add Config"),l("p",{class:"text-sm text-muted-foreground"},"Create a new system setting.")],-1)),o(t(f),{variant:"ghost",size:"sm",onClick:L},{default:n(()=>[...e[19]||(e[19]=[i("Close",-1)])]),_:1})]),l("div",ze,[l("div",null,[e[21]||(e[21]=l("label",{class:"text-xs uppercase tracking-[0.2em] text-muted-foreground"},"Key",-1)),o(t(j),{modelValue:t(y),"onUpdate:modelValue":e[0]||(e[0]=a=>T(y)?y.value=a:null),placeholder:"AI_GENERATION_ENABLED"},null,8,["modelValue"])]),l("div",null,[e[22]||(e[22]=l("label",{class:"text-xs uppercase tracking-[0.2em] text-muted-foreground"},"Value",-1)),o(t(j),{modelValue:t(V),"onUpdate:modelValue":e[1]||(e[1]=a=>T(V)?V.value=a:null),placeholder:"true"},null,8,["modelValue"])]),l("div",null,[e[24]||(e[24]=l("label",{class:"text-xs uppercase tracking-[0.2em] text-muted-foreground"},"Type",-1)),$(l("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>T(C)?C.value=a:null),class:"h-10 w-full rounded-md border border-input bg-background px-3 text-sm"},[...e[23]||(e[23]=[l("option",{value:"string"},"String",-1),l("option",{value:"json"},"JSON",-1),l("option",{value:"boolean"},"Boolean",-1)])],512),[[H,t(C)]])]),l("div",null,[e[25]||(e[25]=l("label",{class:"text-xs uppercase tracking-[0.2em] text-muted-foreground"},"Description",-1)),o(t(K),{modelValue:t(S),"onUpdate:modelValue":e[3]||(e[3]=a=>T(S)?S.value=a:null),placeholder:"Short description"},null,8,["modelValue"])])]),l("div",Ne,[o(t(f),{variant:"outline",onClick:L},{default:n(()=>[...e[26]||(e[26]=[i("Cancel",-1)])]),_:1}),o(t(f),{disabled:t(D),onClick:le},{default:n(()=>[i(A(t(D)?"Creating...":"Create"),1)]),_:1},8,["disabled"])])])]),_:1},8,["modelValue"]),t(U)?(u(),v("div",Ee,A(t(U)),1)):_("",!0),t(G)?(u(),v("div",Le," Failed to load settings. ")):_("",!0)]))}});export{nt as default};
